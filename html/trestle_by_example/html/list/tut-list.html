<html><head>
<title>Trestle by Example:  Scrollable list of strings</title>
</head>

<body>

<ul>
  <li> Root of document: <a href="../tutorial.html">Trestle by Example</a>
  <li> Previous section: <a href="../overlap/tut-overlap.html">Overlapping subwindows</a>
  <li> Next section: <a href="../browser/tut-browser.html">File browser</a>
  <li> Cross listing: <a href="../cross/tut-cross.html">Cross listing by module</a>
</ul>

<hr>

<h1>Scrollable list of strings</h1>

The program
<a href="../../../m3sources/html/trestle_by_example/src/list/List.m3.html">List.m3</a>
shows how to create a scrollable list of strings using <code>ListVBT</code>.
A <code>ListVBT</code>
responds to actions of the mouse.
The user can select an item or items of the list.
<p>

There are several important subprocedure in the <code>ListVBT</code> module.
The subprocedure
<pre>
             insertCells      (at: Cell; n: CARDINAL);
</pre>
inserts <code>n</code> cells beginning with <code>at</code>.
The value of a particular cell can be set with the following subprocedure:
<pre>
             setValue         (this: Cell; value: REFANY);
</pre>
The value of a particular cell can be retrieve using:
<pre>
             getValue         (this: Cell): REFANY;
</pre>
A call to
<pre>
             selectOnly       (this: Cell);
</pre>
makes the given cell the only selected cell.
The subprocedure
<pre>
             getFirstSelected (VAR this: Cell): BOOLEAN;
</pre>
assigns to the variable <code>this</code> the lowest-numbered selected cell
and returns <code>TRUE</code>; if there are no selected cells, it returns
<code>FALSE</code>.
<p>


Actions in response to mouse clicks and drags in the list require the use
of a subtype of the type <code>ListVBT.UniSelector</code> or
the type <code>MultiSelector</code> depending on whether
only one string or multiple strings are to be selected at a time.
The actions to be performed when an item is selected
are given in the methods:
<code>InsideClick</code>, <code>OutsideClick</code>, <code>InsideDrag</code> and <code>OutsideDrag</code>.
<p>

In the program
<a href="../../../m3sources/html/trestle_by_example/src/list/List.m3.html">List.m3</a>
a single cell can be selected at a time.
A mouse click inside a cell selects the item.
Dragging the mouse in the list selects the item
under the cursor as long as the mouse is in the cell.
Moving the mouse into another cell while holding down a button
will select the new cell immediately.
Clicks in the list but outside of all the cells
(in the extra space that may be present at the bottom on the list)
can be caught.
<p>

The following images show two views of the application.
In each case the appearance of the application is depicted
after one of the items in the list has been selected by clicking
on it.
<ul>
  <li> <img src="../list/list1.gif">List 1
  <li> <img src="../list/list2.gif">List 2
</ul>


<hr>

<ul>
  <li> Root of document: <a href="../tutorial.html">Trestle by Example</a>
  <li> Previous section: <a href="../overlap/tut-overlap.html">Overlapping subwindows</a>
  <li> Next section: <a href="../browser/tut-browser.html">File browser</a>

  <li> Cross listing: <a href="../cross/tut-cross.html">Cross listing by module</a>
</ul>

</body>
</html>
