<HTML>
<HEAD>
<TITLE>SRC Modula-3: win32/src/WinVer.i3</TITLE>
</HEAD>
<BODY>
<A NAME="0TOP0">
<H2>win32/src/WinVer.i3</H2></A><HR>
<inInterface>
<PRE><A HREF="../../COPYRIGHT.html">Copyright (C) 1994, Digital Equipment Corp.</A>
</PRE><BLOCKQUOTE><EM>                                                           </EM></BLOCKQUOTE><PRE>
</PRE> by Stephen Harrison                                       
                                                           

<P><PRE>INTERFACE <interface><A HREF="WinVer.m3.html">WinVer</A></interface>;
</PRE>****************************************************************************\
*                                                                             *
* winver.h -    Version management functions, types, and definitions          *
*                                                                             *
*               Include file for VER.DLL.  This library is                    *
*               designed to allow version stamping of Windows executable files*
*               and of special .VER files for DOS executable files.           *
*                                                                             *
*               Copyright (c) 1992, Microsoft Corp.  All rights reserved      *
*                                                                             *
\****************************************************************************

<P><PRE>FROM <A HREF="WinNT.i3.html">WinNT</A> IMPORT LONG, LPWSTR, LPSTR, LPTSTR;
FROM <A HREF="WinDef.i3.html">WinDef</A> IMPORT DWORD, LPDWORD, BOOL, LPVOID;
</PRE> ----- Symbols ----- 
<PRE>VAR                             (* CONST *)
  VS_FILE_INFO: LPTSTR;

CONST
  VS_VERSION_INFO = 1;
  VS_USER_DEFINED = 100;
</PRE> ----- VS_VERSION.dwFileFlags ----- 
<PRE>CONST
  VS_FFI_SIGNATURE    : LONG = 16_FEEF04BD;
  VS_FFI_STRUCVERSION : LONG = 16_00010000;
  VS_FFI_FILEFLAGSMASK: LONG = 16_0000003F;
</PRE> ----- VS_VERSION.dwFileFlags ----- 
<PRE>CONST
  VS_FF_DEBUG       : LONG = 16_00000001;
  VS_FF_PRERELEASE  : LONG = 16_00000002;
  VS_FF_PATCHED     : LONG = 16_00000004;
  VS_FF_PRIVATEBUILD: LONG = 16_00000008;
  VS_FF_INFOINFERRED: LONG = 16_00000010;
  VS_FF_SPECIALBUILD: LONG = 16_00000020;
</PRE> ----- VS_VERSION.dwFileOS ----- 
<PRE>CONST
  VOS_UNKNOWN: LONG = 16_00000000;
  VOS_DOS    : LONG = 16_00010000;
  VOS_OS216  : LONG = 16_00020000;
  VOS_OS232  : LONG = 16_00030000;
  VOS_NT     : LONG = 16_00040000;

  VOS__BASE     : LONG = 16_00000000;
  VOS__WINDOWS16: LONG = 16_00000001;
  VOS__PM16     : LONG = 16_00000002;
  VOS__PM32     : LONG = 16_00000003;
  VOS__WINDOWS32: LONG = 16_00000004;

  VOS_DOS_WINDOWS16: LONG = 16_00010001;
  VOS_DOS_WINDOWS32: LONG = 16_00010004;
  VOS_OS216_PM16   : LONG = 16_00020002;
  VOS_OS232_PM32   : LONG = 16_00030003;
  VOS_NT_WINDOWS32 : LONG = 16_00040004;
</PRE> ----- VS_VERSION.dwFileType ----- 
<PRE>CONST
  VFT_UNKNOWN   : LONG = 16_00000000;
  VFT_APP       : LONG = 16_00000001;
  VFT_DLL       : LONG = 16_00000002;
  VFT_DRV       : LONG = 16_00000003;
  VFT_FONT      : LONG = 16_00000004;
  VFT_VXD       : LONG = 16_00000005;
  VFT_STATIC_LIB: LONG = 16_00000007;
</PRE> ----- VS_VERSION.dwFileSubtype for VFT_WINDOWS_DRV ----- 
<PRE>CONST
  VFT2_UNKNOWN        : LONG = 16_00000000;
  VFT2_DRV_PRINTER    : LONG = 16_00000001;
  VFT2_DRV_KEYBOARD   : LONG = 16_00000002;
  VFT2_DRV_LANGUAGE   : LONG = 16_00000003;
  VFT2_DRV_DISPLAY    : LONG = 16_00000004;
  VFT2_DRV_MOUSE      : LONG = 16_00000005;
  VFT2_DRV_NETWORK    : LONG = 16_00000006;
  VFT2_DRV_SYSTEM     : LONG = 16_00000007;
  VFT2_DRV_INSTALLABLE: LONG = 16_00000008;
  VFT2_DRV_SOUND      : LONG = 16_00000009;
  VFT2_DRV_COMM       : LONG = 16_0000000A;
</PRE> ----- VS_VERSION.dwFileSubtype for VFT_WINDOWS_FONT ----- 
<PRE>CONST
  VFT2_FONT_RASTER  : LONG = 16_00000001;
  VFT2_FONT_VECTOR  : LONG = 16_00000002;
  VFT2_FONT_TRUETYPE: LONG = 16_00000003;
</PRE> ----- VerFindFile() flags ----- 
<PRE>CONST
  VFFF_ISSHAREDFILE = 16_0001;

  VFF_CURNEDEST    = 16_0001;
  VFF_FILEINUSE    = 16_0002;
  VFF_BUFFTOOSMALL = 16_0004;
</PRE> ----- VerInstallFile() flags ----- 
<PRE>CONST
  VIFF_FORCEINSTALL  = 16_0001;
  VIFF_DONTDELETEOLD = 16_0002;

  VIF_TEMPFILE: LONG = 16_00000001;
  VIF_MISMATCH: LONG = 16_00000002;
  VIF_SRCOLD  : LONG = 16_00000004;

  VIF_DIFFLANG  : LONG = 16_00000008;
  VIF_DIFFCODEPG: LONG = 16_00000010;
  VIF_DIFFTYPE  : LONG = 16_00000020;

  VIF_WRITEPROT       : LONG = 16_00000040;
  VIF_FILEINUSE       : LONG = 16_00000080;
  VIF_OUTOFSPACE      : LONG = 16_00000100;
  VIF_ACCESSVIOLATION : LONG = 16_00000200;
  VIF_SHARINGVIOLATION: LONG = 16_00000400;
  VIF_CANNOTCREATE    : LONG = 16_00000800;
  VIF_CANNOTDELETE    : LONG = 16_00001000;
  VIF_CANNOTRENAME    : LONG = 16_00002000;
  VIF_CANNOTDELETECUR : LONG = 16_00004000;
  VIF_OUTOFMEMORY     : LONG = 16_00008000;

  VIF_CANNOTREADSRC: LONG = 16_00010000;
  VIF_CANNOTREADDST: LONG = 16_00020000;

  VIF_BUFFTOOSMALL: LONG = 16_00040000;
</PRE> ----- Types and structures ----- 

<P><PRE>TYPE
  VS_FIXEDFILEINFO = RECORD
    dwSignature       : DWORD;  (* e.g.  16_feef04bd *)
    dwStrucVersion    : DWORD;  (* e.g.  16_00000042 = &quot;0.42&quot; *)
    dwFileVersionMS   : DWORD;  (* e.g.  16_00030075 = &quot;3.75&quot; *)
    dwFileVersionLS   : DWORD;  (* e.g.  16_00000031 = &quot;0.31&quot; *)
    dwProductVersionMS: DWORD;  (* e.g.  16_00030010 = &quot;3.10&quot; *)
    dwProductVersionLS: DWORD;  (* e.g.  16_00000031 = &quot;0.31&quot; *)
    dwFileFlagsMask   : DWORD;  (* = 16_3F for version &quot;0.42&quot; *)
    dwFileFlags       : DWORD;  (* e.g.  VFF_DEBUG | VFF_PRERELEASE *)
    dwFileOS          : DWORD;  (* e.g.  VOS_DOS_WINDOWS16 *)
    dwFileType        : DWORD;  (* e.g.  VFT_DRIVER *)
    dwFileSubtype     : DWORD;  (* e.g.  VFT2_DRV_KEYBOARD *)
    dwFileDateMS      : DWORD;  (* e.g.  0 *)
    dwFileDateLS      : DWORD;  (* e.g.  0 *)
  END;
</PRE> ----- Function prototypes ----- 

<P><PRE>&lt;*EXTERNAL VerFindFileA:APIENTRY*&gt;
PROCEDURE VerFindFileA (uFlags       : DWORD;
                        szFileName   : LPSTR;
                        szWinDir     : LPSTR;
                        szAppDir     : LPSTR;
                        szCurDir     : LPSTR;
                        lpuCurDirLen : LPDWORD;
                        szDestDir    : LPSTR;
                        lpuDestDirLen: LPDWORD  ): DWORD;

&lt;*EXTERNAL VerFindFileW:APIENTRY*&gt;
PROCEDURE VerFindFileW (uFlags       : DWORD;
                        szFileName   : LPWSTR;
                        szWinDir     : LPWSTR;
                        szAppDir     : LPWSTR;
                        szCurDir     : LPWSTR;
                        lpuCurDirLen : LPDWORD;
                        szDestDir    : LPWSTR;
                        lpuDestDirLen: LPDWORD  ): DWORD;

CONST VerFindFile = VerFindFileA;

&lt;*EXTERNAL VerInstallFileA:APIENTRY*&gt;
PROCEDURE VerInstallFileA (uFlags        : DWORD;
                           szSrcFileName : LPSTR;
                           szDestFileName: LPSTR;
                           szSrcDir      : LPSTR;
                           szDestDir     : LPSTR;
                           szCurDir      : LPSTR;
                           szTmpFile     : LPSTR;
                           lpuTmpFileLen : LPDWORD): DWORD;

&lt;*EXTERNAL VerInstallFileW:APIENTRY*&gt;
PROCEDURE VerInstallFileW (uFlags        : DWORD;
                           szSrcFileName : LPWSTR;
                           szDestFileName: LPWSTR;
                           szSrcDir      : LPWSTR;
                           szDestDir     : LPWSTR;
                           szCurDir      : LPWSTR;
                           szTmpFile     : LPWSTR;
                           lpuTmpFileLen : LPDWORD ): DWORD;

CONST VerInstallFile = VerInstallFileA;
</PRE> Returns size of version info in bytes 
<PRE>&lt;*EXTERNAL GetFileVersionInfoSizeA:APIENTRY*&gt;
PROCEDURE GetFileVersionInfoSizeA (lptstrFilename: LPSTR;  (* Filename of
                                                                version
                                                                stamped
                                                                file *)

                                   lpdwHandle: LPDWORD): DWORD;
                        (* Information for use by GetFileVersionInfo *)
</PRE> Returns size of version info in bytes 
<PRE>&lt;*EXTERNAL GetFileVersionInfoSizeW:APIENTRY*&gt;
PROCEDURE GetFileVersionInfoSizeW (lptstrFilename: LPWSTR;  (* Filename
                                                                 of version
                                                                 stamped
                                                                 file *)

                                     lpdwHandle: LPDWORD): DWORD;
       (* Information for use by GetFileVersionInfo *)

CONST GetFileVersionInfoSize = GetFileVersionInfoSizeA;
</PRE> Read version info into buffer 
<PRE>&lt;*EXTERNAL GetFileVersionInfoA:APIENTRY*&gt;
PROCEDURE GetFileVersionInfoA (lptstrFilename: LPSTR;  (* Filename of
                                                            version stamped
                                                            file *)

                                 dwHandle: DWORD;  (* Information from
                                                      GetFileVersionSize *)
                                 dwLen: DWORD;  (* Length of buffer for
                                                   info *)
                                 lpData: LPVOID): BOOL;
  (* Buffer to place the data structure *)
</PRE> Read version info into buffer 
<PRE>&lt;*EXTERNAL GetFileVersionInfoW:APIENTRY*&gt;
PROCEDURE GetFileVersionInfoW (lptstrFilename: LPWSTR;  (* Filename of
                                                             version
                                                             stamped
                                                             file *)

                               dwHandle: DWORD;  (* Information from
                                                      GetFileVersionSize *)
                               dwLen: DWORD;  (* Length of buffer for
                                                   info *)
                               lpData: LPVOID): BOOL;
                         (* Buffer to place the data structure *)

CONST GetFileVersionInfo = GetFileVersionInfoA;

&lt;*EXTERNAL VerLanguageNameA:APIENTRY*&gt;
PROCEDURE VerLanguageNameA (wLang: DWORD; szLang: LPSTR; nSize: DWORD): DWORD;

&lt;*EXTERNAL VerLanguageNameW:APIENTRY*&gt;
PROCEDURE VerLanguageNameW (wLang: DWORD; szLang: LPWSTR; nSize: DWORD): DWORD;

CONST VerLanguageName = VerLanguageNameA;

&lt;*EXTERNAL VerQueryValueA:APIENTRY*&gt;
PROCEDURE VerQueryValueA (pBlock    : LPVOID;
                          lpSubBlock: LPSTR;
                          lplpBuffer: UNTRACED REF LPVOID;
                          lpuLen    : LPDWORD              ): BOOL;

&lt;*EXTERNAL VerQueryValueW:APIENTRY*&gt;
PROCEDURE VerQueryValueW (pBlock    : LPVOID;
                          lpSubBlock: LPWSTR;
                          lplpBuffer: UNTRACED REF LPVOID;
                          lpuLen    : LPDWORD              ): BOOL;

CONST VerQueryValue = VerQueryValueA;

END WinVer.
</PRE>
</inInterface>
<PRE>























</PRE>
</BODY>
</HTML>
