%!PS-Adobe-2.0
%%Creator: dvips 5.55 Copyright 1986, 1994 Radical Eye Software
%%Title: StableObjects.dvi
%%CreationDate: Thu Jan 19 14:07:10 1995
%%Pages: 19
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Times-Roman Courier Times-Bold Times-Italic
%%EndComments
%DVIPSCommandLine: dvips StableObjects.dvi
%DVIPSParameters: dpi=300, comments removed
%DVIPSSource:  TeX output 1995.01.19:1406
%%BeginProcSet: tex.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]{ch-image}imagemask restore}B /D{/cc X dup type /stringtype ne{]}
if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore showpage
userdict /eop-hook known{eop-hook}if}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
%%BeginProcSet: texps.pro
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2
index /UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type /integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics /Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont /setfont load]cvx def}def
/ObliqueSlant{dup sin S cos div neg}B /SlantFont{4 index mul add}def
/ExtendFont{3 -1 roll mul exch}def /ReEncodeFont{/Encoding exch def}def
end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300
(/tmp_mnt/shellgame/r/dlusers9/kalsow/pkg/m3/stable/doc/StableObjects.dvi)
@start /Fa 1 16 df<03C00FF01FF83FFC7FFE7FFEFFFFFFFFFFFFFFFF7FFE7FFE3FFC
1FF80FF003C010107E9115>15 D E /Fb 81[28 51[22 25 25 1[25
28 17 19 22 1[28 25 28 41 14 28 17 14 28 25 17 22 28
22 28 25 12[33 28 36 2[39 36 4[19 1[39 1[33 36 36 11[25
25 25 25 25 25 25 2[12 46[{}43 50.000000 /Times-Bold
rf /Fc 39 122 df<0018007800F001C0038007000E000E001C001C0038003800700070
007000E000E000E000E000E000E000E000E000E000E00070007000380038001C000E0007
0003000D21789C16>40 D<06000700038001C000E0007000700070003800380038003800
3800380038003800380038003800700070007000E000E001C00380038007000E001C0078
00F000C0000D217C9C16>I<7FFF80FFFF807FFF8011037C8D16>45
D<3078F878300505788416>I<00FC0003FF0007FF800E03C01E01C00E01C00001C00001
C0000380000F0001FE0003FC0001FE00000F00000380000380000380000380600380F007
80E00700F01E007FFC003FF8000FE00012197D9816>51 D<06000F000F800F0006000000
000000000000000000000000000018003C007C003C001C001C0038003800F000E000C000
0918799116>59 D<0000C00003E00007C0001F00007E0001F80003E0000F80003F00007C
0000F000007800003E00001F000007C00003E00000F000007C00003E00000F0000060013
157C9616>I<3FFFC07FFFE07FFFE0000000000000000000000000000000FFFFC0FFFFC0
7FFF80130B7D9116>I<1800001C00001F00000F800003E00001F000007800003E00001F
000007C00003C0000FC0003F00007C0001F00007E0000F80003E0000FC0000F00000C000
0012157D9616>I<0FFF001FFFC00FFFC00381E00700E00700E00700E00700E00701C007
03C00FFF800FFF000FFF800E0F800E03C00E01C01C01C01C01C01C01C01C01C01C03801C
0F80FFFF00FFFE00FFF80013197E9816>66 D<007C6001FEE003FFE00783E00E01C01C01
C03C01C03801C0700000700000700000E00000E00000E00000E00000E00000E00000E003
00F00700700700780E003C1C001FF8000FF00007C00013197C9816>I<07FFF80FFFFC07
FFFC01C01C03803803803803801803800003800003830007070007FF0007FF0007FF0007
07000706000E00000E00300E00700E00700E00700E00707FFFE0FFFFE07FFFE016197F98
16>69 D<0FE0FE1FF1FF0FE0FE0380380700700700700700700700700700700700700FFF
E00FFFE00FFFE00E00E00E00E00E00E01C01C01C01C01C01C01C01C01C01C01C01C0FE0F
E0FF0FF0FE0FE018197F9816>72 D<0FF8000FFC000FF80001C000038000038000038000
0380000380000380000700000700000700000700000700000700000E00000E00200E0070
0E00700E00700E00707FFFE0FFFFE07FFFE014197F9816>76 D<0FC07E0FE0FE0FE0FE03
A1B80761700763700763700763700766700766700E66E00E6EE00E6CE00E6CE00E78E00E
78E01C31C01C01C01C01C01C01C01C01C01C01C07E07E0FE0FE07E07E017197F9816>I<
0FC0FE1FE1FF0FE0FE03A0380730700730700730700730700730700730700E38E00E38E0
0E38E00E38E00E18E00E18E01C19C01C1DC01C1DC01C1DC01C0DC01C0DC0FE0F80FF0F80
FE078018197F9816>I<01FF8007FFC00FFFE01E01E01C00E01C00E03800E03800E03800
E03800E07001C07001C07001C07001C07001C07001C0F00380E00380E00380E00780F007
00F80F00FFFE007FFC001FF80013197D9816>I<0FFE001FFF800FFFC00383E00701E007
00E00700E00700E00701E00701C00E07800FFF800FFE000FFE000E07000E07001C07001C
07001C07001C07101C07381C0770FE07F0FF03E0FE01C015197F9816>82
D<007E3001FFF003FFF00781F00E00E01C00E01C00601C00001C00000E00000FE00007FC
0001FF00001F800003C00001C00001C00001C03001C07001C0700380780F00FFFE00FFFC
0047F00014197E9816>I<7FFFE07FFFF07FFFF0707070E0E0E0E0E0E060E06000E00000
E00000E00001C00001C00001C00001C00001C00001C00003800003800003800003800003
80000380003FE0003FF0003FE00014197C9816>I<7F07F0FF8FF87F07F01C01C0380380
380380380380380380380380380380700700700700700700700700700700700700E00E00
E00E00E00E00E01C00703C007878003FF0001FE00007800015197C9816>I<07F0001FFC
001FFE001C0F0008070000070000070003FF001FFF003F0E00780E00E00E00E00E00E01E
00F03E007FFFC03FCFC01F07C012127D9116>97 D<7C00007E00007E00000E00001C0000
1C00001C00001C7C001DFE001FFF003F07803C03803803803803C03801C03801C0700380
700380700380700700780F00783E00EFFC00E7F00063E00012197C9816>I<00FE0003FF
0007FF800F07001C0200380000700000700000700000E00000E00000F000007006007807
003C1E001FFC000FF80007E00011127C9116>I<0007C00007E00007E00000E00001C000
01C00001C001F1C007FDC00FFFC01F07803C0380380380700380700380700380E00700E0
0700F00700700F00700F00783F003FFFC01FEFE00787C013197E9816>I<00FC0003FE00
0FFF001F07803C03803801C07001C07FFFC07FFFC0FFFF80E00000700000700300780380
3C0F001FFF000FFC0003F00012127D9116>I<003E3800FFFC01FFFE03C3CC0381C00701
C00701C00701C007038007878003FF0007FE000EF8000C00000E00000FFE000FFF801FFF
C03C01E07000E07000E0E000E0E000E07001E07C07C03FFF801FFE0007F800171C809116
>103 D<003000780078003000000000000000001FE01FF01FF000E000E000E000E000E0
00E001C001C001C001C001C001C0FFFEFFFEFFFE0F1A7C9916>105
D<07F8000FFC0007FC00001C000038000038000038000038000038000038000070000070
0000700000700000700000700000E00000E00000E00000E00000E00000E0007FFF80FFFF
807FFF8011197E9816>108 D<1E78F03FFDF81FFFF80F9F380F1E380E1C380E1C380E1C
380E1C381C38701C38701C38701C38701C38701C3870FE7CF8FF7EFCFE3C781612809116
>I<1F1F003FBF801FFFC007E1C00781C00701C00701C00701C00701C00E03800E03800E
03800E03800E03800E0380FF8FE0FFCFF0FF8FE014127F9116>I<00F80003FE000FFF00
1F0F803C07803803807001C07001C07001C0E00380E00380F00780700700780F007C3E00
3FFC001FF00007C00012127D9116>I<07C3E00FEFF007FFF801F83C01E01C01C01C01C0
1E01C00E01C00E03801C03801C03801C03803803C07803C1F0077FE0073F80071F000700
000700000700000E00000E00000E00007FC000FFC0007FC000171B819116>I<1FC1F01F
E7F81FEFFC01DE1801F80001E00001E00001C00001C00003800003800003800003800003
80000380007FFC00FFFC007FFC0016127F9116>114 D<01F90007FF800FFF801E070038
07003803003C00001FE0000FF80001FE00000E00300700700700700700781E00FFFC00FF
F80047E00011127D9116>I<03000380070007000700FFFEFFFFFFFE0E000E000E000E00
0E000E001C001C041C0E1C0E1C1C1C3C1FF80FF007C010177C9616>I<FF1FC0FF3FE0FF
1FC03C0E001C0E001C1C001C1C001C3C001C38001C38001C70000C70000EE0000EE0000E
C0000FC0000F800007000013127C9116>118 D<1FC7E03FCFF01FC7E0038F0003CE0001
DC0001F80000F00000F00000F00001F00003B800073C000F1C001E1E00FE3F80FF3FC0FE
3F8014127E9116>120 D<1FE3F81FE7FC1FE3F80381C00381C003838003838003838001
C70001C70001CE0001CE0001CC0000DC0000D80000F80000F00000F00000E00000E00001
C00001C000738000F78000FF0000FE0000780000161B7F9116>I
E /Fd 37 123 df<0008001000200040008001800300030006000E000C001C0018001800
38003000300070007000600060006000E000E000E000E000E000C000C000C000E000E000
600060006000600030003000100008000C0004000D2A7B9E10>40
D<0100008000C00040006000200030003000300018001800180018001800180018001800
18001800380038003800300030007000700060006000E000C000C0018001800300030006
000400080018003000600080000D2A809E10>I<387878380808101020204080050C7D83
0C>44 D<7070F06004047C830C>46 D<0C1E1C1C000000000000000000007070F0600712
7C910C>58 D<0FFFFC0000F8078000F001C000F000E000F0007000F0007000F0007801E0
003801E0003801E0003801E0003801E0003C01E0003803C0003803C0007803C0007803C0
007803C0007003C000F0078000E0078000E0078001C0078003800780078007800E000F00
1C000F007000FFFFC0001E1C7E9B20>68 D<07FF00F800F000F000F000F000F001E001E0
01E001E001E001E003C003C003C003C003C003C00780078007800780078007800F000F80
FFF0101C7F9B0F>73 D<0007F00000381C0000E00E0001C0030003800380070001C00E00
01C01E0001E01C0000E03C0000E0380000E0780000F0780000F0780000F0F00001E0F000
01E0F00001E0F00001E0F00003C0F00003C0F00003C0700007807000070078000F003800
1E003C001C001C0038000E00E0000383800000FE00001C1E7C9C20>79
D<1FFFFFF03C07C0F03007803020078020600780204007802040078020400F0020800F00
20000F0000000F0000000F0000000F0000001E0000001E0000001E0000001E0000001E00
00001E0000003C0000003C0000003C0000003C0000003C0000003C000000780000007C00
001FFFE0001C1C7C9B1E>84 D<FFF01FF01F0007801E0003001E0002001E0002001E0002
001E0002003C0004003C0004003C0004003C0004003C0004003C00040078000800780008
0078000800780008007800080078000800F0001000F00010007000100070002000700020
0038004000380080001C0100000E0E000001F000001C1D7A9B1F>I<FFE1FFC0FF801F00
3E003E000F001E0018000F001E0018000F001E0010000F001E0030000F001E0020000F00
3E0060000F802F00400007804F00C00007804F00800007808F01800007808F0100000781
0F01000007C10782000003C20782000003C20784000003C60784000003C40788000003CC
0788000003C807D0000001F803D0000001F003E0000001F003E0000001E003C0000001E0
03C0000001C00380000000C001800000008001000000291D7B9B2B>87
D<07F0001C18001E0C001C0E00180E00000E00000E0001FE000F0E001C1C00301C00701C
00E01C40E01C40E03C40E05C80709D803F0E0012127D9115>97 D<3F00000F00000E0000
0E00000E00000E00000E00000E00001C00001C00001C00001C7C001D87001E01803C0180
3801C03800C03800E03800E03800E07001C07001C07001C0700380700300700600F00C00
CC380083E000131D7C9C17>I<00FE000307000E07801C07003806003800007000007000
00700000E00000E00000E000006000007002007004003008001C300007C00011127E9112
>I<0001F80000780000700000700000700000700000700000700000E00000E00000E000
F8E00386E00601E00C01C01801C03801C07001C07001C07001C0E00380E00380E0038060
0380700380300780300F001C378007C7E0151D7E9C17>I<01F8070C0C06180738033003
70037FFF7000E000E000E00060006002700430081C3007C010127E9112>I<000F800039
C00061C000E3C001C18001C00001C00001C0000380000380000380003FF8000380000380
000700000700000700000700000700000700000E00000E00000E00000E00000E00000E00
001C00001E0000FFC000121D7F9C0D>I<000038007CCC01871C0303080703800E03800E
03800E03800E03800E0700060600070C0009F0000800001800001800001FFE000FFF800F
FFC03001C06000C06000E0C000C0C000C0600180200300180E0007F000161C809215>I<
07E00001E00001C00001C00001C00001C00001C00001C000038000038000038000038F80
03B0C003C0E00780E00780E00700E00700E00700E00700E00E01C00E01C00E01C00E01C0
0E01C00E01C01C03801E03C0FF9FF0141D7F9C17>I<00C001C001C00180000000000000
00000000000000001F80078003800700070007000700070007000E000E000E000E000E00
0E001C001E00FF800A1D7F9C0C>I<000300070007000600000000000000000000000000
00007E001E000E001C001C001C001C001C001C0038003800380038003800380070007000
7000700070007060E0F0E0F1C063803E001025849C0D>I<07E00001E00001C00001C000
01C00001C00001C00001C0000380000380000380000381FC0380E00380C0070100070200
07080007100007300007F8000F38000E3C000E1C000E1E000E0E000E0F001C07001C0F80
FF9FE0161D7F9C16>I<07E001E001C001C001C001C001C001C003800380038003800380
03800700070007000700070007000E000E000E000E000E000E001C001E00FF800B1D7F9C
0C>I<1F8FC0FC00079061060003E0760700078078070007807807000700700700070070
0700070070070007007007000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E
000E00E00E001C01C01C001E01E01E00FF8FF8FF8021127F9124>I<1F8F8007B0C003C0
E00780E00780E00700E00700E00700E00700E00E01C00E01C00E01C00E01C00E01C00E01
C01C03801E03C0FF9FF014127F9117>I<00FC000307000E01801C01C03800C03000C070
00E07000E07000E0E001C0E001C0E001C0600180600380700700380E001C180007E00013
127E9115>I<0FC7C003D87001E03803C01803801C03800C03800E03800E03800E07001C
07001C07001C0700380700300700600F00C00EC3800E3E000E00000E00000E00001C0000
1C00001C00001C0000FF8000171A809117>I<00F8200384600602E00C01C01801C03801
C07001C07001C07001C0E00380E00380E00380600380700380300780380F001C370007C7
00000700000700000700000E00000E00000E00000E00007FC0131A7E9116>I<1F9C07EE
03CF078E078C07000700070007000E000E000E000E000E000E001C001E00FFC010127F91
10>I<03F20C0E18061004300438043E001FE00FF007F8003C401C400C400C6018E010D0
608FC00F127F9110>I<020002000200060006000C001C003C00FFE01C001C0038003800
3800380038003800700070407040704070407080708031001E000B1A7C9910>I<FC1F80
3C07801C0380380700380700380700380700380700380700700E00700E00700E00700E00
701E00701E00703C00305E001F9F8011127C9117>I<FF07E03C03803C03001C02001C02
001C04001C08000E08000E10000E10000E20000F200007400007C0000780000700000300
0002000013127C9116>I<FF3FC7E03C0F0380380E0100380E03003C1F02001C1706001C
3704001C270C001C6308001C4318001EC390000E83B0000F83A0000F03E0000F01C0000E
01C0000E018000040180001B127C911E>I<1FE1FC0781E003808003C10001C20000E600
00EC00007800007000003800007C00009C00011E00020E000407000C07003C0780FE1FF0
16127F9116>I<0FF07E03C03803C03001C02001C02001C04001C08000E08000E10000E1
0000E20000F200007400007C000078000070000030000020000020000040000040007080
00F10000F30000E60000780000171A809116>I<0FFF800E0700080E00180E00101C0010
380010700000E00001C00001C0000382000702000E02001C0400380400380C00703800FF
F80011127F9112>I E /Fe 75 126 df<60F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0600000
000060F0F0600419779816>33 D<E038F078F078F078F078F078F078F078E038E0386030
0D0B7C9816>I<3801807C03807C0380EE0700EE0700EE0E00EE0E00EE0E00EE1C007C1C
007C380038380000700000700000700000E00000E00001C00001C00001C0000380000383
800707C00707C00E0EE00E0EE00E0EE01C0EE01C0EE03807C03807C018038013207F9C16
>37 D<03800007E0000FE0001E70001C70001C70001C70001CF7E01CE7E01DC7E00FC700
0F8E000F0E001F0E003F1C007B9C00739C00E1F800E1F800E0F0E0E0F0E071F8E07FFFC0
3F9FC01E070013197F9816>I<30787C3C1C1C1C1C3878F0E040060D789816>I<00E001E0
038007000E001C001C0038003800700070007000E000E000E000E000E000E000E000E000
E000700070007000380038001C001C000E000700038001E000E00B217A9C16>I<C000E0
00700038001C000E000E000700070003800380038001C001C001C001C001C001C001C001
C001C0038003800380070007000E000E001C0038007000E000C0000A217B9C16>I<0380
038003800380E38EF39EFFFE3FF80FE00FE03FF8FFFEF39EE38E03800380038003800F12
7D9516>I<00E00000E00000E00000E00000E00000E00000E00000E000FFFFE0FFFFE0FF
FFE000E00000E00000E00000E00000E00000E00000E00000E00013137F9516>I<387C7E
7E3E0E1E1C78F060070B798416>I<FFFF80FFFF80FFFF8011037E8D16>I<70F8F8F87005
05788416>I<03E0000FF8001FFC001E3C00380E00780F00700700700700E00380E00380
E00380E00380E00380E00380E00380E00380F00780700700700700780F003C1E001E3C00
1FFC000FF80003E00011197E9816>48 D<0300070007000F001F00FF00FF00E700070007
00070007000700070007000700070007000700070007000700FFF8FFF8FFF80D197B9816
>I<07E0001FF8003FFC00783E00E00700F00780F0038060038000038000038000070000
0700000E00001C0000380000700000E00001C0000380000F00001E03803803807FFF80FF
FF807FFF8011197E9816>I<07E0001FF8003FFC00781E00780700300700000700000700
000E00003E0007FC0007F00007FC00001E00000700000300000380000380600380F00380
E00700781E003FFC001FF80007E00011197E9816>I<70F8F8F870000000000000000070
F8F8F8700512789116>58 D<387C7C7C38000000000000000038787C7C3C1C1C3870F040
0618799116>I<000180000780001F80003E0000F80001F00007C0000F80003E0000FC00
00F00000FC00003E00000F800007C00001F00000F800003E00001F800007800001801115
7E9616>I<7FFFC0FFFFE0FFFFE0000000000000000000000000000000FFFFE0FFFFE07F
FFC0130B7F9116>I<C00000F00000FC00003E00000F800007C00001F00000F800003E00
001F80000780001F80003E0000F80001F00007C0000F80003E0000FC0000F00000C00000
11157E9616>I<00E00001F00001F00001B00001B00003B80003B80003B800031800071C
00071C00071C00071C00071C000E0E000E0E000FFE000FFE001FFF001C07001C07001C07
007E0FC0FF1FE07E0FC013197F9816>65 D<7FF800FFFE007FFF001C07001C07801C0380
1C03801C03801C03801C07001FFF001FFE001FFE001C1F001C03801C03C01C01C01C01C0
1C01C01C01C01C03C01C07807FFF80FFFF007FFC0012197F9816>I<01F18007FB800FFF
801F0F803C0780380380700380700380F00000E00000E00000E00000E00000E00000E000
00E00000F000007003807003803803803C07001F0F000FFE0007FC0001F00011197E9816
>I<7FF800FFFE007FFF001C0F001C07801C03C01C01C01C01C01C01E01C00E01C00E01C
00E01C00E01C00E01C00E01C00E01C00E01C01C01C01C01C03C01C07801C0F807FFF00FF
FE007FF8001319809816>I<7FFFC0FFFFC07FFFC01C01C01C01C01C01C01C01C01C0000
1C00001C1C001C1C001FFC001FFC001FFC001C1C001C1C001C00001C00E01C00E01C00E0
1C00E01C00E07FFFE0FFFFE07FFFE013197F9816>I<7FFFE0FFFFE07FFFE01C00E01C00
E01C00E01C00E01C00001C00001C1C001C1C001FFC001FFC001FFC001C1C001C1C001C00
001C00001C00001C00001C00001C00007F8000FFC0007F800013197F9816>I<01F18007
FB800FFF801F0F803C0780380380700380700380F00000E00000E00000E00000E00000E0
1FC0E01FE0E01FC0F003807003807007803807803C07801E0F800FFF8007FB8001F38013
197F9816>I<7F07F0FF8FF87F07F01C01C01C01C01C01C01C01C01C01C01C01C01C01C0
1FFFC01FFFC01FFFC01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C0
7F07F0FF8FF87F07F01519809816>I<7FFCFFFE7FFC0380038003800380038003800380
0380038003800380038003800380038003800380038003807FFCFFFE7FFC0F197D9816>
I<01FF0003FF8001FF00001C00001C00001C00001C00001C00001C00001C00001C00001C
00001C00001C00001C00001C00001C00001C00001C00601C00F01C00F038007FF8007FF0
001FC00011197E9816>I<7F0FE0FF8FF07F0FE01C07801C0F001C0E001C1C001C3C001C
78001CF0001CE0001DF0001FF0001FF8001F38001E1C001C1C001C0E001C0E001C07001C
07001C03807F07E0FF8FF07F07E01419809816>I<FF8000FFC000FF80001C00001C0000
1C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C0000
1C00401C00E01C00E01C00E01C00E0FFFFE0FFFFE0FFFFE013197F9816>I<FC07E0FE0F
E0FE0FE03A0B803B1B803B1B803B1B803B1B803B1B803BBB8039B38039B38039B38039B3
8039F38038E38038E380380380380380380380380380380380FE0FE0FE0FE0FE0FE01319
7F9816>I<7E07F0FF0FF87F07F01D81C01D81C01D81C01DC1C01CC1C01CE1C01CE1C01C
61C01C71C01C71C01C71C01C31C01C39C01C39C01C19C01C1DC01C0DC01C0DC01C0DC07F
07C0FF87C07F03C01519809816>I<1FFC003FFE007FFF00780F00F00780E00380E00380
E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380
F00780F00780780F007FFF003FFE001FFC0011197E9816>I<7FF800FFFE007FFF001C0F
801C03801C03C01C01C01C01C01C01C01C03C01C03801C0F801FFF001FFE001FF8001C00
001C00001C00001C00001C00001C00001C00007F0000FF80007F000012197F9816>I<1F
FC003FFE007FFF00780F00F00780E00380E00380E00380E00380E00380E00380E00380E0
0380E00380E00380E00380E00380E00380E0E380E1E380F0F780787F007FFF003FFE001F
FC00001C00001E00000E00000F00000700000700111F7E9816>I<7FF000FFFC007FFE00
1C0F001C07801C03801C03801C03801C03801C07801C0F001FFE001FFC001FFE001C0E00
1C07001C07001C07001C07001C07101C07381C07387F03F0FF83F07F01E01519809816>
I<07E3001FFF003FFF00781F00F00700E00700E00700E00000F000007800003F80001FF0
0007FC0000FE00000F00000700000380000380600380E00380E00700F80F00FFFE00FFFC
00C7F00011197E9816>I<7FFFE0FFFFE0FFFFE0E0E0E0E0E0E0E0E0E0E0E0E000E00000
E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000
E00000E00007FC000FFE0007FC0013197F9816>I<7F07F0FF8FF87F07F01C01C01C01C0
1C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C0
1C01C01C01C00E03800E038007070007FF0003FE0000F8001519809816>I<FE0FE0FE0F
E0FE0FE03803803C07801C07001C07001C07001E0F000E0E000E0E000E0E000E0E00071C
00071C00071C00071C0003180003B80003B80003B80001B00001F00001F00000E0001319
7F9816>I<7E03F0FF07F87E03F03800E03800E03800E03800E01C01C01C01C01C01C01C
71C01CF9C01CF9C01CD9C01CD9C00CD9800CD9800CD9800DDD800D8D800D8D800D8D8007
8F00078F000707001519809816>I<7F1F807F3FC07F1F800E1E000E1C00071C00073800
03B80003F00001F00001E00000E00001E00001F00003F00003B80007B800071C000F1C00
0E0E000E0E001C07007E0FC0FF1FE07E0FC013197F9816>I<FE0FE0FF1FE0FE0FE01C07
001C07000E0E000E0E00071C00071C00071C0003B80003B80001F00001F00000E00000E0
0000E00000E00000E00000E00000E00000E00003F80007FC0003F80013197F9816>I<C0
0000E00000E000007000007000003800003800001C00001C00000E00000E000007000007
000003800003800001C00001C00000E00000E000007000007000003800003800001C0000
1C00000E00000E0000070000070000038000038000018011207E9C16>92
D<FFFF80FFFF80FFFF8011037E7E16>95 D<1FE0003FF0007FF800783C00300E00000E00
000E0003FE001FFE003E0E00700E00E00E00E00E00E00E00783E007FFFE03FE7E00F83E0
13127E9116>97 D<FC0000FC0000FC00001C00001C00001C00001C00001C7C001DFE001F
FF001F07801E03C01C01C01C00E01C00E01C00E01C00E01C00E01C00E01C01C01E03C01F
07801FFF001DFE000C780013197F9816>I<03F80FFC1FFE3C1E780C7000E000E000E000
E000E000F000700778073E0E1FFC0FF803F010127D9116>I<003F00003F00003F000007
0000070000070000070003C7000FF7001FFF003C1F00780F00700700E00700E00700E007
00E00700E00700E00700700F00780F003C1F001FFFE00FF7E007C7E013197F9816>I<03
F0000FFC001FFE003C0F00780700700380E00380FFFF80FFFF80FFFF80E00000E0000070
03807803803E07801FFF0007FE0001F80011127E9116>I<001E00007F0001FF8001C780
0383000380000380007FFF00FFFF00FFFF00038000038000038000038000038000038000
0380000380000380000380000380000380007FFC00FFFE007FFC0011197F9816>I<03E3
C007F7E00FFFE01C1CC0380E00380E00380E00380E00380E001C1C000FF8001FF0001BE0
003800001800001FFC001FFF003FFF807003C0E000E0E000E0E000E0E000E07001C07C07
C03FFF800FFE0003F800131C7F9116>I<FC0000FC0000FC00001C00001C00001C00001C
00001C78001DFC001FFE001F0F001E07001C07001C07001C07001C07001C07001C07001C
07001C07001C07001C0700FF8FE0FF9FE0FF8FE013197F9816>I<030007800780030000
00000000000000FF80FF80FF800380038003800380038003800380038003800380038003
80FFFCFFFEFFFC0F1A7C9916>I<7E0000FE00007E00000E00000E00000E00000E00000E
7FE00E7FE00E7FE00E0F000E1E000E3C000E78000EF0000FF0000FF8000FBC000F1E000E
0E000E07000E07807F87F0FFCFF07F87F01419809816>107 D<7FC000FFC0007FC00001
C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001
C00001C00001C00001C00001C00001C00001C0007FFF00FFFF807FFF0011197E9816>I<
F9C380FFEFC0FFFFE03C78E03C78E03870E03870E03870E03870E03870E03870E03870E0
3870E03870E03870E0FE7CF8FE7CF8FE7CF81512809116>I<FC7800FDFC00FFFE001F0F
001E07001C07001C07001C07001C07001C07001C07001C07001C07001C07001C0700FF8F
E0FF9FE0FF8FE013127F9116>I<03E0000FF8001FFC003C1E00780F00700700E00380E0
0380E00380E00380E00380F00780700700780F003C1E001FFC000FF80003E00011127E91
16>I<FC7C00FDFE00FFFF001F07801E03C01C01C01C00E01C00E01C00E01C00E01C00E0
1C00E01C01C01E03C01F07801FFF001DFE001C78001C00001C00001C00001C00001C0000
1C0000FF8000FF8000FF8000131B7F9116>I<03E3800FF3801FFB803E0F807807807007
80E00380E00380E00380E00380E00380E003807007807807803C1F801FFB800FF38003E3
80000380000380000380000380000380000380001FF0003FF8001FF0151B7F9116>I<7F
0FC0FF3FE07F7FE007F04007C00007800007800007000007000007000007000007000007
00000700000700007FFC00FFFC007FFC0013127F9116>I<0FEC3FFC7FFCF03CE01CE01C
70007F801FF007F8003C600EE00EF00EF81EFFFCFFF8C7E00F127D9116>I<0300000700
000700000700000700007FFF00FFFF00FFFF000700000700000700000700000700000700
0007000007010007038007038007038007870003FE0001FC0000F80011177F9616>I<FC
3F00FC3F00FC3F001C07001C07001C07001C07001C07001C07001C07001C07001C07001C
07001C07001C1F001FFFE00FF7E007C7E013127F9116>I<7F1FC0FF9FE07F1FC01C0700
1C07000E0E000E0E000E0E00071C00071C00071C00071C0003B80003B80003B80001F000
01F00000E00013127F9116>I<FF1FE0FF1FE0FF1FE038038038038038038038038039F3
8039F38019F30019B30019B30019B3001DB7001D17001F1F000F1E000E0E0013127F9116
>I<7F1FC07F3FC07F1FC00F1E00073C0003B80003F00001F00000E00001E00001F00003
B800073C00071C000E0E007F1FC0FF3FE07F1FC013127F9116>I<7F1FC0FF9FE07F1FC0
1C07000E07000E0E000E0E00070E00071C00071C00039C00039C0003980001B80001B800
00F00000F00000F00000E00000E00000E00001C00079C0007BC0007F80007F00003C0000
131B7F9116>I<001F80007F8000FF8001E00001C00001C00001C00001C00001C00001C0
0001C00001C00001C00003C0007F8000FF0000FF00007F800003C00001C00001C00001C0
0001C00001C00001C00001C00001C00001C00001E00000FF80007F80001F8011207E9C16
>123 D<E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0
0320779C16>I<7C0000FF0000FF800003C00001C00001C00001C00001C00001C00001C0
0001C00001C00001C00001E00000FF00007F80007F8000FF0001E00001C00001C00001C0
0001C00001C00001C00001C00001C00001C00003C000FF8000FF00007C000011207E9C16
>I E /Ff 81[21 52[18 18 2[21 12 16 16 1[21 21 21 30 12
18 12 12 21 21 12 18 21 18 21 21 13[21 25 1[25 30 1[35
3[14 4[30 28 25 25 13[21 1[21 3[14 45[{}36 41.666668
/Times-Italic rf /Fg 1 59 df<60F0F06004047C830C>58 D
E /Fh 134[21 21 2[23 14 16 18 1[23 21 23 35 12 2[12 23
21 14 18 23 18 23 21 12[28 23 30 1[25 2[39 28 2[16 3[28
1[30 9[21 1[21 21 21 21 21 21 21 3[14 45[{}38 41.666668
/Times-Bold rf /Fi 134[30 30 2[33 20 23 27 1[33 30 33
50 17 2[17 33 30 20 27 33 27 33 30 12[40 33 43 4[56 40
6[40 1[43 11[30 30 30 30 30 30 30 49[{}34 59.999973 /Times-Bold
rf /Fj 134[25 25 25 1[25 25 25 25 25 25 25 25 25 25 25
25 25 25 25 25 25 25 25 25 25 1[25 1[25 1[25 1[25 3[25
25 25 25 1[25 25 25 25 25 1[25 25 25 1[25 25 25 25 25
25 2[25 25 25 1[25 25 1[25 1[25 25 25 25 25 1[25 25 25
25 1[25 25 25 5[25 34[{}65 41.666668 /Courier rf /Fk
69[18 8[21 1[23 23 3[18 47[18 21 21 30 21 21 12 16 14
21 21 21 21 32 12 21 12 12 21 21 14 18 21 18 21 18 3[14
1[14 1[30 1[39 1[30 25 23 28 30 23 30 30 37 25 1[16 14
30 30 23 25 30 28 28 30 3[23 1[12 12 21 21 21 21 21 21
21 21 21 21 12 10 14 10 2[14 14 14 39[{}75 41.666668
/Times-Roman rf /Fl 134[25 3[25 14 19 17 2[25 25 1[14
2[14 25 25 1[22 1[22 1[22 9[47 8[36 3[19 2[36 3[33 9[25
3[25 3[25 4[12 44[{}23 50.000000 /Times-Roman rf /Fm
139[20 28 6[20 1[20 4[32 1[32 36 32 13[40 3[52 79[{}10
72.000000 /Times-Roman rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
1 0 bop 765 436 a Fm(Stable)17 b(Objects)623 556 y Fl(Carsten)12
b(W)l(eich)158 b(Greg)12 b(Nelson)803 654 y(January)g(19,)h(1995)320
807 y Fk(A)e(stable)g(object)g(is)g(an)h(object)f(whose)g(state)g
(survives)g(program)g(crashes.)19 b(This)11 b(document)257
857 y(describes)i(a)f(stable)g(objects)f(package)i(for)f(Modula-3.)17
b(For)12 b(example,)h(this)e(package)i(could)e(be)257
907 y(used)e(to)e(implement)h(a)h(simple)f(database,)i(such)e(as)h(a)g
(replica)f(of)g(a)h(name)g(server)g(for)e(a)i(distributed)257
957 y(system.)16 b(As)11 b(another)f(example,)i(this)e(package)h(could)
f(be)h(used)g(to)f(make)i(an)f(application)e(like)h(a)257
1006 y(text)g(editor)f(more)i(robust,)e(so)i(that)e(it)h(doesn')o(t)g
(lose)g(edits)g(if)f(it)h(or)g(the)g(system)h(crashes.)320
1056 y(The)c(generic)h(interface)f Fj(Stable)g Fk(de\256nes)g(a)h
(stable)f(version)f(of)h(any)g(given)g(object)f(type.)13
b(The)257 1106 y(stub)c(generator)f Fj(stablegen)h Fk(will)e(produce)i
(the)g(part)f(of)h(the)g(implementation)e(of)i(a)g(stable)g(ob-)257
1156 y(ject)h(type)f(which)g(depends)g(of)g(type)g(of)h(the)f(stable)g
(object.)14 b(The)c(generic)f(module)g Fj(StableRep)257
1206 y Fk(contains)e(the)g(type)g(independend)g(part)g(of)g(the)g
(implementation.)12 b(The)c Fj(LogManager)e Fk(interface)257
1256 y(allows)k(you)g(to)f(control)g(how)h(and)h(where)f(the)g(stable)h
(state)f(is)g(stored.)257 1395 y Fi(Contents)257 1488
y Fh(1)42 b(The)10 b(generic)i(interface)f(Stable)852
b(2)320 1538 y Fk(1.1)43 b(Exceptions)23 b Fg(:)d(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)
h(:)f(:)g(:)h(:)f(:)g(:)g(:)66 b Fk(5)320 1588 y(1.2)43
b(Customizations)12 b Fg(:)21 b(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)
66 b Fk(5)257 1679 y Fh(2)42 b(The)10 b(generic)i(module)e(StableRep)
806 b(5)257 1770 y(3)42 b(LogManager)10 b(interface)952
b(7)257 1862 y(4)42 b(Manpage)10 b(for)g(the)h(stub)g(generator)785
b(9)320 1911 y Fk(4.1)43 b(Name)13 b Fg(:)20 b(:)h(:)f(:)g(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)
g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)66 b Fk(9)320 1961
y(4.2)43 b(Syntax)27 b Fg(:)21 b(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)
g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)g(:)66 b Fk(9)320 2011 y(4.3)43 b(Description)13
b Fg(:)20 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)45
b Fk(10)320 2061 y(4.4)e(Classifying)9 b(the)h(methods)32
b Fg(:)20 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)45 b Fk(10)320 2111 y(4.5)e(Options)10
b Fg(:)21 b(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)47
b Fk(1)n(1)320 2160 y(4.6)c(Restrictions)d Fg(:)20 b(:)h(:)f(:)g(:)h(:)
f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)g(:)47 b Fk(1)n(1)320 2210 y(4.7)c(Generating)10
b(stubs)g(using)f(m3build)32 b Fg(:)20 b(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)
h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)47 b Fk(1)n(1)257
2302 y Fh(5)42 b(Sample)9 b(stub)i(generator)g(output)799
b(12)963 2628 y Fk(1)p eop
%%Page: 2 2
2 1 bop 257 262 a Fh(6)42 b(Example)1170 b(14)320 311
y Fk(6.1)43 b(Object)10 b(Interface)37 b Fg(:)20 b(:)g(:)h(:)f(:)g(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)
h(:)f(:)g(:)g(:)45 b Fk(14)320 361 y(6.2)e(Object)10
b(Implementation)17 b Fg(:)j(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)
f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)45
b Fk(15)320 411 y(6.3)e(Driving)9 b(the)h(stable)g(object)24
b Fg(:)c(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)
h(:)f(:)g(:)h(:)f(:)g(:)g(:)45 b Fk(16)320 461 y(6.4)e(The)11
b(make)g(\256le)h Fg(:)20 b(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)g(:)
45 b Fk(19)257 552 y Fh(7)d(Copyright)1145 b(19)257 692
y Fi(1)60 b(The)15 b(generic)d(interface)h(Stable)257
809 y Fk(A)e Ff(stable)g(object)f Fk(is)h(an)g(object)g(whose)g(state)g
(is)g(stored)g(on)f(the)h(disk)f(or)h(other)g(medium)g(whence)257
859 y(its)f(state)g(can)h(be)g(recovered)g(if)f(a)h(program)f(crashes.)
320 909 y(The)j(generic)f(interface)h Fe(Stable)e Fk(de\256nes)i(a)g
(subtype)e(of)h(a)h(given)f(object)g(type)g(that)f(is)i(just)257
959 y(like)c(that)g(object)f(type,)i(but)e(stable.)14
b(The)c(generic)f(ar)o(gument)h(to)f Fe(Stable)f Fk(is)h(an)g
(interface)h(named)257 1009 y Fe(Data)p Fk(,)h(which)f(is)h(assumed)g
(to)g(contain)f(an)h(object)f(type)g(named)i Fe(Data.T)p
Fk(.)e(Thus)g(the)h(type)f Fe(Sta-)257 1058 y(ble\(Data\).T)g
Fk(is)h(like)g(a)h Fe(Data.T)p Fk(,)f(but)g(stable.)18
b(In)11 b(case)i(of)e(a)h(failure)f(\(of)g(either)g(the)h(program)257
1108 y(or)e(the)g(system\))h(such)f(objects)g(can)h(recover)g(by)f
(resuming)g(their)f(last)h(recorded)h(state.)320 1158
y(The)h(state)h(of)e(a)i(stable)f(object)g(is)g(stored)f(as)i(a)g
(checkpoint)e(together)g(with)g(a)i(redo)f(log;)g(the)257
1208 y(log)e(contains)g(entries)g(for)f(all)h(updates)h(performed)f
(since)h(the)f(last)g(checkpoint.)j(These)f(updates)257
1258 y(are)h(recorded)e(by)g(logging)f(a)i(number)f(identifying)e(an)i
(update)g(method,)h(together)f(with)f(the)h(ar)o(-)257
1308 y(guments)g(of)g(the)g(method.)17 b(The)12 b(typical)e(cost)h(for)
g(an)g(update)g(is)g(therefore)g(on)g(the)g(order)g(of)g(the)257
1357 y(cost)g(of)f(a)g(single)g(disk)g(write.)320 1407
y(In)g(order)g(to)g(keep)h(the)f(redo)g(log)g(from)g(growing)f(without)
g(bound)g(\(which)h(would)f(cause)j(the)257 1457 y(recovery)d(time)f
(to)f(grow)h(without)e(bound\),)h(it)g(is)h(necessary)i(to)d
(periodically)g(write)g(a)i(new)f(check-)257 1507 y(point.)k(While)7
b(writing)f(a)i(new)g(checkpoint)f(the)g(data)h(structure)f(is)h
(unavailable)f(for)g(updating.)k(As)257 1557 y(a)g(client)f(of)g(the)g
Fe(Stable)f Fk(package,)j(you)d(can)i(control)e(how)h(often)g
(checkpoints)g(are)h(made.)320 1606 y(The)d(strategy)f(used)h(by)f(the)
g Fe(Stable)f Fk(package)j(is)e(described)h(more)g(fully)e(by)h(Andrew)
g(D.)h(Bir)o(-)257 1656 y(rell,)g(Michael)f(B.)g(Jones,)i(and)e(Edward)
g(P)-5 b(.)8 b(W)m(obber)f(in)f(\252A)i(simple)e(and)h(ef)o(\256cient)h
(implementation)257 1706 y(for)13 b(small)f(databases\272,)k
Ff(Pr)n(oceedings)e(of)e(the)g(1)m(1th)g(ACM)g(Symposium)g(on)h
(Operating)e(System)257 1756 y(Principles)p Fk(.)j(This)c(paper)h(is)f
(also)g(available)h(as)f(SRC)g(Research)i(Report)d(24,)h(January)h
(1988.)320 1806 y(The)i(stable)f(stub)g(generator)g Fe(stablegen)f
Fk(will)g(automatically)h(produce)g(an)h(implementa-)257
1855 y(tion)c(of)h(any)g(generic)h(instance)f Fe(Stable\(Data\))p
Fk(.)i(The)f(default)e(implementation)g(produced)h(by)257
1905 y Fe(stablegen)5 b Fk(reads)j(and)f(writes)f(checkpoints)g(using)g
(the)h(pickles)g(package,)i(and)d(reads)i(and)f(writes)257
1955 y(the)k(redo)g(log)f(using)f(the)i(same)h(marshaling)f(mechanism)h
(as)f(the)g(network)f(objects)g(stub)g(gener)o(-)257
2005 y(ator)h(\()p Fe(stubgen)p Fk(\).)j(This)d(is)g(suitable)f(for)g
(many)i(applications,)e(but)g(not)g(for)h(all.)k(The)d(comments)257
2055 y(at)f(the)e(end)i(of)e(the)h(interface)h(explain)e(how)h(to)f
(customize)i(the)e(behavior)h(of)g(the)f(stable)i(package)257
2105 y(in)f(several)h(dif)o(ferent)f(ways.)320 2154 y(The)j
(initialization)d(method)j(for)f(a)i(stable)f(object)f(will)g(reset)i
(it)e(to)g(the)h(stable)g(state,)h(if)f(the)257 2204
y(stable)e(state)f(is)g(present;)g(otherwise)g(the)g(method)g(creates)h
(and)g(initializes)d(the)j(stable)f(state.)320 2254 y(By)h(default,)i
(the)f(stable)g(state)g(\(checkpoint)f(and)h(log\))f(for)h(an)g(object)
g(is)g(stored)g(in)f(a)i(direc-)257 2304 y(tory)d(in)h(the)g(ordinary)e
(\256le)i(system.)17 b(It)11 b(is)f(possible)h(to)f(override)g(this)g
(default.)16 b(For)11 b(example,)h(in)257 2354 y(a)g(system)f(that)g
(contains)f(some)i(form)e(of)h(stable)g(random)g(access)i(memeory)m(,)g
(it)d(may)h(be)g(prefer)o(-)257 2403 y(able)i(for)f(reasons)h(of)g
(speed)g(to)f(keep)h(the)f(stable)g(data)h(in)f(the)h(stable)f(RAM)g
(instead)g(of)h(on)f(the)257 2453 y(disk.)h(This)c(\257exibility)e(is)i
(provided)e(by)i(an)g(abstraction)g(called)g(a)h Fe(LogManager)p
Fk(,)d(which)i(is)g(basi-)257 2503 y(cally)h(an)g(object)g(that)f
(provides)g(streams)i(for)e(logs)h(and)f(checkpoints.)14
b(A)c Fe(LogManager)e Fk(may)i(be)963 2628 y(2)p eop
%%Page: 3 3
3 2 bop 257 262 a Fk(provided)8 b(when)i(a)g(stable)f(object)g(is)g
(initialized;)f(if)h(omitted,)g(the)g(default)g(log)f(manager)j(is)e
(used,)257 311 y(which)i(stores)g(the)h(log)e(and)h(checkpoint)g(in)g
(the)g(ordinary)f(\256le)h(system.)18 b(See)12 b Fe(LogManager.i3)257
361 y Fk(for)e(details.)320 411 y(The)i(stub)f(generator)g(produces)h
(overrides)f(for)g(all)g(update)g(methods)h(of)f(the)g(stable)h
(object.)257 461 y(The)h(override)e(method)h(writes)f(its)g(parameters)
i(together)f(with)e(a)j(method)e(number)h(to)f(the)h(log,)257
511 y(and)h(then)e(calls)i(the)f(corresponding)f(method)g(of)h(its)g
(supertype.)19 b(Finally)11 b(they)h(write)g(an)g(addi-)257
560 y(tional)c Fe(commit)g Fk(record)i(to)f(the)g(log)f(to)h(record)g
(that)g(the)g(method)g(terminated.)k(\(If)c(a)h(crash)g(occurs)257
610 y(while)j(the)g(method)h(is)f(running,)g(the)g(commit)g(record)h
(will)e(not)h(be)g(present)h(and)f(the)h(call)f(that)257
660 y(crashed)f(will)c(not)i(be)g(repeated)h(during)e(recovery)m(.\))
320 710 y(The)j(recovery)h(process)f(is)g(started)g(by)g
Fe(init)f Fk(if)h(a)g(stable)h(backup)f(is)f(found)h(for)f(the)h
(object)257 760 y(being)f(initialized.)k(T)m(o)d(recover)n(,)g(the)f
(log)g(manager)h(is)f(used)g(to)g(obtain)f(a)i(reader)g(on)f(the)g
(check-)257 809 y(point,)e(the)h Fe(readCheckpoint)c
Fk(method)k(of)f(the)h(object)f(is)g(used)h(to)f(reconstruct)h(an)g
(object)f(from)257 859 y(the)j(checkpoint.)18 b(The)13
b(log)e(manager)i(is)f(also)f(used)i(to)e(obtain)g(a)h(reader)h(on)e
(the)h(redo)g(log.)18 b(The)257 909 y(entries)13 b(in)e(the)h(redo)h
(log)e(are)i(read,)h(and)f(the)f(recorded)g(updates)h(are)g(replayed.)
20 b(Any)12 b(returned)257 959 y(values)h(or)f(exceptions)f(from)h
(these)h(methods)f(are)h(ignored.)18 b(If)12 b(update)g(methods)g(use)h
Fe(VAR)e Fk(pa-)257 1009 y(rameters,)h(the)d(recovery)h(procedure)g
(will)f(pass)h(dummies)g(to)f(them)h(that)f(contain)g(the)h(same)h
(val-)257 1059 y(ues)f(the)f(originally)e(passed)k(variables)e(had.)14
b(Notice)9 b(that)g(if)g(an)h(update)f(method)g(reads)h(or)f(writes)257
1108 y(any)k(state)f(other)g(that)f(the)h(\256elds)h(of)f(the)g(stable)
g(object)g(itself,)g(the)g(recovery)h(process)g(may)f(not)257
1158 y(work)e(as)h(expected.)320 1208 y(A)g Fe(Stable\(Data\).T)e
Fk(is)i(unmonitored.)17 b(The)12 b(client)f(is)g(responsible)g(for)g
(ensuring)f(that)h(it)257 1258 y(is)g(not)e(updated)h(concurrently)f
(nor)h(updated)g(while)g(a)h(checkpoint)e(is)h(written.)j(Clients)c
(are)j(also)257 1308 y(responsible)d(to)g(write)g(checkpoints)f
(periodically)g(by)h(calling)g(the)g Fe(Checkpoint\(\))e
Fk(procedure.)357 1407 y Fe(GENERIC)20 b(INTERFACE)g(Stable\(Data\);)
257 1482 y Fk(Where)11 b Fe(Data.T)e Fk(is)h(an)h(object)e(type.)14
b(Also,)c(the)g Fe(Data)f Fk(interface)i(should)e(contain)g(a)i(pragma)
f(in-)257 1532 y(dicating)h(which)g(methods)g(of)g Fe(Data.T)f
Fk(are)i(update)f(methods,)h(as)g(explained)f(in)g(the)g(man)h(page)257
1582 y(for)e(the)g(stub)g(generator)g Fe(stablegen)p
Fk(.)357 1679 y Fe(IMPORT)21 b(LogManager,)e(StableError,)g(Pathname,)h
(Wr,)h(Rd;)357 1752 y(CONST)401 1800 y(Brand)f(=)i("\(Stable")e(&)h
(Data.Brand)f(&)i("\)";)401 1849 y(DefaultBrand)d(=)i("\(Default)f(")i
(&)g(Brand)e(&)i("\)";)357 1912 y Fd(This)16 b(branding)f(is)h
(required)h(for)f(all)f(generic)i(in)o(terfaces.)25 b(The)17
b(Data)e(in)o(terface)357 1961 y(m)o(ust)e(con)o(tain:)519
2036 y Fc(CONST)21 b(Brand)f(=)i(<text-constant>;)357
2159 y Fe(TYPE)f(T)h(<:)f(Public;)466 2206 y(Public)g(=)g(Data.T)g
(OBJECT)f(METHODS)531 2254 y(init\(nm:)g(Pathname.T;)g(VAR)h
(recovered:)f(BOOLEAN;)619 2302 y(forceToDisk)f(:=)i(TRUE;)g(lm:)g
(LogManager.T)f(:=)h(NIL\):)g(T)619 2350 y(RAISES)f({StableError.E};)
531 2397 y(dispose\(\))g(RAISES)h({StableError.E};)531
2445 y(flushLog\(\))42 b(RAISES)20 b({StableError.E};)531
2493 y(freeLog\(\))g(RAISES)h({StableError.E};)963 2628
y Fk(3)p eop
%%Page: 4 4
4 3 bop 531 262 a Fe(writeCheckpoint)19 b(\(wr:)i(Wr.T\))g(RAISES)f
({StableError.E};)531 309 y(readCheckpoint)f(\(rd:)i(Rd.T\):)g(T)g
(RAISES)g({StableError.E};)466 359 y(END;)257 434 y Fk(The)8
b(call)f Fe(st.init\(nm,)19 b(recovered,)h(forceToDisk,)f(lm\))7
b Fk(makes)h(the)e(object)h Fe(st)f Fk(stable,)257 484
y(with)j(stable)h(state)g(stored)g(by)f(the)h(log)f(manager)i
Fe(lm)f Fk(under)g(the)f(name)i Fe(nm)p Fk(.)j(If)c(this)f(stable)h
(state)g(is)257 533 y(present)h(when)f Fe(init)g Fk(is)g(called,)h
(then)f(recovery)h(is)f(initiated,)f Fe(recovered)g Fk(is)h(set)h(to)e
Fe(TRUE)p Fk(,)i(and)257 583 y(the)h(recovered)h(object)f(is)g
(returned.)19 b(Otherwise,)12 b(the)g(state)h(of)e Fe(st)h
Fk(is)g(recorded)g(stably)g(and)g Fe(st)257 633 y Fk(itself)h(is)g
(returned.)24 b(It)13 b(is)g(a)h(runtime)f(error)h(to)f(call)g
Fe(st.init)f Fk(twice)i(without)e(an)h(intervening)257
683 y Fe(st.dispose)c Fk(\(see)i(below\).)320 733 y(If)6
b Fe(forceToDisk)f Fk(is)h Fe(TRUE)p Fk(,)h(the)g(log)f(will)f(be)i
(\257ushed)g(after)g(every)g(update)g(method.)12 b(If)7
b Fe(force-)257 782 y(ToDisk)g Fk(is)g(false,)i(the)e(log)g(will)f(be)i
(\257ushed)f(only)g(when)g(the)h(client)f(calls)g(the)h
Fe(flushLog)e Fk(method.)257 832 y(Leaving)h Fe(forceToDisk)e
Fk(false)i(is)g(more)g(ef)o(\256cient,)h(but)e(if)h Fe(forceToDisk)t
Fk(is)g(false)g(and)g Fe(flushLog)257 882 y Fk(is)i(not)g(called)g
(frequently)m(,)g(recovery)g(may)h(fail)f(to)f(replay)h(some)h(update)f
(methods.)14 b(The)c(number)257 932 y(of)g(lost)g(updates)g(depends)g
(on)g(how)g(much)h(buf)o(fering)e(is)h(performed)g(by)g(the)g(log)f
(manager)n(.)320 982 y(If)k Fe(lm)f Fk(is)h Fe(NIL)p
Fk(,)g(then)g(the)g(\256le)h(system)f(log)f(manager)j(is)e(used.)23
b(This)13 b(means)h(that)f Fe(nm)f Fk(is)h(in-)257 1032
y(terpreted)e(as)h(the)f(name)h(of)f(a)g(\256le)h(system)f(directory)m
(,)g(in)g(which)f(the)h(stable)g(state)h(is)f(stored)f(as)i(a)257
1081 y(checkpoint)e(and)g(redo)g(log)g(\256le.)320 1131
y(The)j(method)f(call)h Fe(st.freeLog\(\))d Fk(closes)j(the)f(log)g
(writer)g(for)g Fe(st)p Fk(.)20 b(The)14 b(log)d(will)h(be)g(re-)257
1181 y(opened)g(by)g(the)g(next)f(call)h(to)f(an)i(update)e(method.)19
b(Freeing)12 b(the)f(log)h(might)e(be)j(necessary)m(,)h(for)257
1231 y(example,)e(to)e(prevent)g(running)f(out)h(of)h(\256le)f
(descriptors)g(if)g(many)h(stable)g(objects)f(are)i(allocated)257
1281 y(but)e(few)g(are)h(active)g(at)f(once.)320 1330
y(The)i Fe(readcheckpoint)e Fk(method)h(must)h(reconstruct)g(a)g(data)h
(structure)e(equivalent)g(to)h(the)257 1380 y(one)f(written)e(by)h
Fe(writecheckpoint)p Fk(.)i(By)e(default,)g(both)g(of)g(these)h
(methods)f(use)h(pickles,)f(but)257 1430 y(you)g(can)h(override)f(them)
g(if)g(you)f(want)i(to.)320 1480 y(The)e(call)g Fe(st.dispose\(\))e
Fk(deletes)i(the)g(stable)g(state)h(of)e Fe(st)p Fk(.)14
b(It)8 b(should)g(be)h(called)h(when)f(sta-)257 1530
y(bility)d(for)i Fe(st)g Fk(is)g(no)g(longer)g(desired.)13
b(The)c(stability)e(of)h(an)g(object)g(and)h(modi\256cations)e(to)h
(its)f(state)257 1579 y(are)k(orthogonal.)h(That)f(is,)f(update)g
(methods)h(may)f(be)h(called)f(after)h(a)g(call)f(to)g
Fe(st.dispose.)357 1679 y(PROCEDURE)20 b(Checkpoint\(t:)f(T\))i(RAISES)
g({StableError.E};)357 1741 y Fd(W)m(rite)13 b(a)h(new)g(c)o(hec)o(kp)q
(oin)o(t)h(for)e Fc(t)h Fd(and)g(empt)o(y)e(its)i(redo)h(log.)257
1816 y Fk(Y)l(ou)10 b(are)h(responsible)f(for)f(calling)h
Fe(Checkpoint)e Fk(periodically)m(,)i(to)f(prevent)h(the)g(redo)g(log)g
(from)257 1866 y(growing)c(without)t(bound.)12 b(It)7
b(is)f(a)i(runtime)e(error)g(to)g(call)h Fe(Checkpoint)e
Fk(after)i(calling)f Fe(st.dispose,)257 1916 y Fk(unless)11
b(the)f(object)f(has)i(subsequently)e(been)i(restabilized)f(with)f
Fe(st.init.)357 2015 y(END)21 b(Stable.)257 2159 y Fb(1.1)50
b(Exceptions)257 2237 y Fk(The)10 b Fe(StableError.E)c
Fk(exception)i(is)g(raised)h(in)f(various)g(circumstances.)15
b(The)9 b(\256rst)g(element)g(of)257 2286 y(the)h Fe(AtomList.T)f
Fk(ar)o(gument)h(identi\256es)f(the)h(nature)g(of)g(the)g(error)n(.)k
(Subsequent)9 b(elements)i(may)257 2336 y(identify)e(further)h(details)
h(of)f(the)h(error)n(,)g(especially)g(in)f(the)h(case)h(when)f(lower)o
(-level)f(exceptions)257 2386 y(are)h(propagated)f(by)g(the)g
Fe(Stable)f Fk(package.)963 2628 y(4)p eop
%%Page: 5 5
5 4 bop 257 262 a Fb(1.2)50 b(Customizations)320 339
y Fa(\017)20 b Fk(If)10 b(you)f(don')o(t)f(want)i(every)g(update)f(to)h
(be)g(\257ushed)f(to)g(disk,)h(set)g Fe(forceToDisk)d
Fk(to)j Fe(FALSE)361 389 y Fk(when)e(initializing)e(the)i(stable)g
(object,)h(and)f(\257ush)g(the)g(log)g(manually)g(with)f(the)h
Fe(flushLog)361 439 y Fk(method.)320 521 y Fa(\017)20
b Fk(If)12 b(you)f(don')o(t)f(want)i(to)f(use)h Fe(Pickle)e
Fk(for)i(checkpointing,)e(override)h(the)h Fe(writeCheck-)361
571 y(point\(\))7 b Fk(and)i Fe(readCheckpoint\(\))c
Fk(methods)j(of)g(the)h(stable)f(object)g(to)g(read)h(and)f(write)361
621 y(checkpoints)i(in)g(your)f(preferred)i(format.)j(\(If)c(you)g(are)
h(aiming)f(at)g(long-lived)e(persistent)361 671 y(state)i(you)f(should)
g(avoid)g(pickles,)h(since)h(new)f(versions)f(of)h(the)f(Modula-3)g
(system)h(can')o(t)361 721 y(always)h(read)g(pickles)f(written)f(by)g
(earlier)i(versions.\))320 803 y Fa(\017)20 b Fk(If)11
b(you)f(don')o(t)g(want)h(to)f(store)h(the)f(stable)h(state)g(in)g(the)
f(ordinary)g(\256le)h(system,)h(implement)361 853 y(your)c(own)h(log)f
(manager)i(\(as)f(explained)f(in)h(the)f Fe(LogManager)f
Fk(interface\))i(and)g(pass)g(your)361 903 y(own)h(manager)h(to)f(the)g
Fe(init)g Fk(method)g(instead)g(of)f(the)i(default.)320
985 y Fa(\017)20 b Fk(If)8 b(you)g(don')o(t)f(want)h(to)g(use)g
(network-object)f(style)h(marshaling)g(for)f(recording)h(the)g(update)
361 1035 y(method)j(calls)g(in)f(the)h(redo)g(log,)g(you)f(will)g(have)
h(to)g(write)f(you)h(own)f(implementation)g(of)361 1085
y(of)e Fe(Stable\(Data\).m3)d Fk(instead)j(of)g(using)g(the)g(stub)g
(generator)g Fe(stablegen)p Fk(.)j(\(Y)l(ou)d(may)361
1135 y(still)h(\256nd)h(it)f(helpful)g(to)h(use)h(the)f(generated)g
(code)h(as)g(starting)e(point.\))257 1339 y Fi(2)60 b(The)15
b(generic)d(module)j(StableRep)257 1456 y Fk(The)d(generic)f(module)g
Fe(StableRep)e Fk(provides)h(the)h(part)g(of)g(the)g(implementation)e
(of)i(stable)g(ob-)257 1505 y(jects)f Fe(Stable.T)e Fk(that)h(is)g
(independent)f(of)h Fe(Data.T)g Fk(\(see)h Fe(Stable.ig)e
Fk(for)h(a)h(description)e(of)h(the)257 1555 y(methods\).)k(It)8
b(is)g(not)g(intended)f(that)h(any)g(client)g(calls)g(anything)f(in)h
(this)f(interface)i(directly)m(.)j(Only)257 1605 y(the)e(generated)h
(code)g(references)h(this)d(interface.)320 1655 y(This)i(code)h(is)g
(used)f(by)h(the)f(code)h(generated)g(by)f Fe(stablegen)p
Fk(.)17 b(It)11 b(contains)g(everything)f(of)257 1705
y(the)f(generated)h(stable)f(implementation)f(that)h(does)g(not)g(need)
g(to)g(be)g(generated)h(by)f Fe(stablegen)p Fk(.)257
1754 y(However)n(,)k(it)e(has)i(to)e(be)h(generic)g(because)h(there)f
(are)g(\256elds)g(and)g(a)g(method)g(added)g(to)f(the)g(user)257
1804 y(object)f(which)g(are)h(referencend)g(in)f(this)f(module.)320
1854 y(The)h(method)f Fe(unspoolLog)f Fk(is)i(added.)k(The)c(method)g
(is)f(generated)i(by)e Fe(stablegen)f Fk(and)i(is)257
1904 y(called)h(by)f Fe(Recover\(\))p Fk(.)i(It)e(reads)h(the)f(log)f
(and)i(calls)f(every)h(method)f(recorded)g(on)g(it.)357
2000 y Fe(GENERIC)20 b(INTERFACE)g(StableRep\(StableDat)o(a\);)357
2072 y(IMPORT)h(StableError,)e(StableLog,)h(LogManager,)f(Pathname;)357
2120 y(IMPORT)i(OSError,)f(Wr,)h(Rd;)357 2192 y(REVEAL)g(StableData.T)e
(<:)i(Public;)357 2264 y(TYPE)401 2312 y(Public)f(=)i(StableData.Publi)
o(c)d(BRANDED)h(OBJECT)531 2360 y(nm)196 b(:)22 b(Pathname.T;)531
2408 y(log)174 b(:)22 b(Wr.T;)531 2455 y(lm)196 b(:)22
b(LogManager.T)d(:=)i(NIL;)531 2503 y(forceToDisk:)f(BOOLEAN;)963
2628 y Fk(5)p eop
%%Page: 6 6
6 5 bop 488 262 a Fe(METHODS)531 309 y(replayLog\(log:)19
b(Rd.T\);)488 357 y(OVERRIDES)531 405 y(init)261 b(:=)21
b(Init;)531 452 y(dispose)195 b(:=)21 b(Dispose;)531
500 y(flushLog)173 b(:=)21 b(FlushLog;)531 548 y(freeLog)195
b(:=)21 b(FreeLog;)531 596 y(writeCheckpoint)e(:=)i(WriteCheckpoint;)
531 643 y(readCheckpoint)41 b(:=)21 b(ReadCheckpoint;)488
693 y(END;)257 827 y Fh(Implementations)10 b(of)f Fe(Stable.ig)p
Fh(-methods)357 950 y Fe(PROCEDURE)20 b(Init)h(\()87
b(self)152 b(:)21 b(Public;)793 998 y(dir)174 b(:)21
b(Pathname.T;)706 1046 y(VAR)g(recovered)42 b(:)21 b(BOOLEAN;)793
1094 y(forceToDisk)324 b(:=)22 b(TRUE;)793 1141 y(lm)196
b(:)21 b(LogManager.T)e(:=)j(NIL)65 b(\))401 1189 y(:)21
b(StableData.T)401 1237 y(RAISES)f({StableError.E};)357
1308 y(PROCEDURE)g(Dispose)g(\(self:)h(Public\))f(RAISES)h
({StableError.E};)357 1380 y(PROCEDURE)f(FlushLog)g(\(self:)h(Public\))
f(RAISES)h({StableError.E})o(;)357 1428 y(PROCEDURE)f(FreeLog)g
(\(self:)h(Public\))f(RAISES)h({StableError.E};)357 1499
y(PROCEDURE)f(ReadCheckpoint)f(\(self:)h(Public;)1163
1547 y(cp)44 b(:)21 b(Rd.T)217 b(\))401 1595 y(:)21 b(StableData.T)401
1643 y(RAISES)f({StableError.E};)357 1690 y(PROCEDURE)g
(WriteCheckpoint)f(\(self:)h(Public;)h(wr:)g(Wr.T\))401
1740 y(RAISES)f({StableError.E};)257 1814 y Fh(Pr)o(ocedur)o(es)14
b(to)c(be)h(called)f(fr)o(om)g(the)h(generated)g(code)357
1937 y Fe(PROCEDURE)20 b(Recover)g(\(t:)h(StableData.T\):)e
(StableData.T)401 1987 y(RAISES)h({StableError.E,)f(StableLog.Error,)f
(OSError.E};)357 2049 y Fd(Do)c(the)h(reco)o(v)o(ery:)20
b(Only)14 b(called)g(if)f Fc(t.lm.recoverable\()o(\))f
Fd(has)i(returned)i Fc(TRUE)p Fd(.)357 2099 y(The)g(pro)q(cedure)h
(follo)o(ws)c(the)j(proto)q(col)f(describ)q(ed)i(in)d
Fc(LogManager.i3)f Fd(to)h(read)357 2149 y(in)g(the)h(latest)g(c)o(hec)
o(kp)q(oin)o(t.)21 b(Then)15 b(it)g(will)e(read)i(the)g(log)f(if)g
(necessary)i(b)o(y)f(calling)357 2198 y Fc(t.replayLog\(\))p
Fd(.)357 2294 y Fe(PROCEDURE)20 b(Checkpoint)g(\(t:)h(StableData.T\))
401 2344 y(RAISES)f({StableError.E};)357 2405 y Fd(W)m(rite)13
b(a)h(c)o(hec)o(kp)q(oin)o(t)g(follo)o(wing)e(the)i(proto)q(coll)f
(describ)q(ed)j(in)e Fc(LogManager.i3)357 2503 y Fe(PROCEDURE)20
b(ReOpenLog)g(\(self:)g(StableData.T\);)963 2628 y Fk(6)p
eop
%%Page: 7 7
7 6 bop 357 262 a Fd(Used)14 b(b)o(y)f(the)g(generated)h(co)q(de)g(to)f
(op)q(en)g(the)h(log:)i(The)e(pro)q(cedure)h(tests)f(whether)357
311 y(the)e(log)e(is)h(already)g(op)q(ened)h(for)f(writing)g(and)g
(reop)q(ens)i(it)e(\(using)g(the)h(log)e(manager)357
361 y(ob)r(ject\))15 b(if)e(not.)18 b(In)c(case)h(of)e(an)h(exception,)
g(it)f(will)g(halt)g(\()p Fc(StableError.Halt)p Fd(\).)357
453 y Fe(END)21 b(StableRep.)257 549 y Fi(3)60 b(LogManager)14
b(interface)257 663 y Fk(A)e Fe(LogManager)d Fk(provides)h(an)i(object)
e(which)h(manages)i(readers)f(and)f(writers)g(for)f(the)h(log)g(and)257
713 y(checkpoint)f(\256les)g(used)h(by)f(stable)g(objects.)320
762 y(The)h(default)f(log)g(manager)h(stores)g(the)f(stable)h(state)f
(in)g(the)h(\256le)f(system.)16 b(Since)11 b(the)f(default)257
812 y(is)f(satisfactory)g(for)g(most)g(applications,)g(most)g(clients)f
(of)h(stable)h(objects)e(don')o(t)h(need)g(to)g(use)h(the)257
862 y(LogManager)h(interface)g(directly)m(.)320 912 y(A)c(situation)t
(in)g(which)f(you)g(might)g(want)h(to)f(use)h(this)f(interface)h(is)g
(if)f(you)g(want)h(to)f(test)h(whether)257 962 y(a)12
b(checkpoint)e(is)h(available)g(before)g(initializing)d(a)k(stable)f
(object.)16 b(In)11 b(this)f(case)i(the)f Fe(recover-)257
1012 y(able)c Fk(method)h(of)g(the)f(log)g(manager)i(will)e(be)h
(useful)f(to)g(you.)13 b(As)8 b(another)g(example,)h(if)e(you)h(don')o
(t)257 1061 y(want)j(to)f(use)h(the)f(\256le)h(system)g(for)f(storing)f
(the)h(stable)h(state,)g(you)f(will)f(need)i(to)f(study)g(the)g(spec-)
257 1111 y(i\256cations)h(in)h(this)f(interface)h(and)g(implement)f
(your)g(own)g(log)g(manager)i(that)e(stores)h(the)g(stable)257
1161 y(state)f(in)f(your)f(preferred)h(form)h(of)e(stable)i(storage.)
357 1251 y Fe(INTERFACE)20 b(LogManager;)401 1320 y(IMPORT)g(Pathname,)
g(Wr,)h(Rd,)g(OSError;)401 1389 y(TYPE)g(T)g(<:)h(Public;)444
1458 y(Public)f(=)g(OBJECT)g(METHODS)531 1505 y(beginCheckpoint\(nm:)d
(Pathname.T\):)i(Wr.T)g(\(*)i(new)f(checkpoint)f(*\))619
1553 y(RAISES)g({OSError.E};)531 1601 y(endCheckpoint\(nm:)f
(Pathname.T\):Wr.T)f(\(*)j(new)h(log)f(*\))619 1649 y(RAISES)f
({OSError.E};)531 1696 y(reOpenLog\(nm:)f(Pathname.T\):)h(Wr.T)h
(RAISES)f({OSError.E};)531 1744 y(recover\(nm:)g(Pathname.T;)f(VAR)j
(log,)f(checkp:)f(Rd.T\))619 1792 y(RAISES)g({OSError.E};)531
1839 y(recoverable\(nm:)f(Pathname.T\):)g(BOOLEAN)619
1887 y(RAISES)h({OSError.E};)531 1935 y(emptyLog\(nm:)g(Pathname.T\):)f
(BOOLEAN)619 1983 y(RAISES)h({OSError.E};)531 2030 y(dispose\(nm:)g
(Pathname.T\))619 2078 y(RAISES)g({OSError.E};)488 2126
y(END;)444 2195 y(DefaultPublic)f(=)j(T)f(OBJECT)g(METHODS)f(init\(\):)
h(Default)f(END;)444 2243 y(Default)h(<:)g(DefaultPublic;)444
2311 y(VAR)g(default:)f(Default;)357 2382 y(END)h(LogManager.)257
2453 y Fk(A)8 b Fe(LogManager.T)d Fk(manages)k(a)f(repository)d(of)j
(named)g(stable)f(snapshots.)13 b(A)7 b(snapshot)g(consists)257
2503 y(of)j(two)g(sequences)i(of)d(bytes,)i(a)g Ff(checkpoint)f
Fk(and)g(a)h Ff(r)n(edo)g(log)p Fk(.)i(The)e(repository)e(must)h(be)g
(stable;)963 2628 y(7)p eop
%%Page: 8 8
8 7 bop 257 262 a Fk(that)12 b(is,)h(it)f(must)g(survive)g(program)g
(crashes.)21 b(Here)13 b(are)g(speci\256cations)g(for)f(the)g(methods)g
(of)g(a)257 311 y Fe(LogManager.T)c Fk(named)j Fe(lm)p
Fk(:)320 361 y(The)f Fe(beginCheckpoint)c Fk(and)j Fe(endCheckpoint)e
Fk(methods)i(are)h(used)f(to)g(write)f(a)i(new)g(sta-)257
411 y(ble)g(snapshot.)k(The)d(call)419 486 y Fe(lm.beginCheckpoint\()o
(nm\))257 560 y Fk(returns)f(a)h(writer)e(whose)i(tar)o(get)f(is)g(the)
g(checkpoint)g(named)h Fe(nm)f Fk(in)f Fe(lm)p Fk(')n(s)h(repository)m
(.)j(The)e(call)441 635 y Fe(lm.endCheckpoint\(n)o(m\))257
710 y Fk(should)h(be)h(made)g(only)f(after)g(a)h(previous)f(call)h(to)f
Fe(lm.beginCheckpoi)o(nt\(n)o(m\))p Fk(.)18 b(The)13
b Fe(end-)257 760 y(Checkpoint)e Fk(method)h(commits)g(the)h(bytes)f
(that)g(have)g(been)h(written)e(to)h(the)h(writer)e(that)h(was)257
809 y(returned)f(by)f Fe(beginCheckpoint)p Fk(,)e(making)j(them)g
(become)h(the)f(new)g(checkpoint.)k(The)c Fe(end-)257
859 y(Checkpoint)e Fk(method)h(also)g(empties)g(the)h(redo)f(log)f(and)
h(returns)g(a)h(writer)e(that)h(can)h(be)g(used)f(to)257
909 y(extend)g(the)h(now-empty)e(redo)h(log.)320 959
y(Therefore,)h(to)f(make)h(a)g(new)f(checkpoint,)g(you)g(should)f
(execute)i(the)f(following)e(steps:)419 1034 y Fe(wr1)21
b(:=)h(lm.beginCheckpoin)o(t\(nm)o(\);)419 1083 y Fk(write)10
b(a)h(new)f(checkpoint)g(to)31 b Fe(wr1;)419 1133 y(wr2)21
b(:=)h(lm.endCheckpoint\()o(nm\);)419 1183 y Fk(new)11
b(checkpoint)e(is)h(made;)h(log)f(updates)g(to)31 b Fe(wr2)257
1258 y Fk(If)10 b(the)f(application)f(exits)h(or)h(crashes)h(before)e
(the)h(call)f(to)g Fe(endCheckpoint)p Fk(,)f(any)i(bytes)f(written)257
1308 y(to)h Fe(wr1)g Fk(will)g(be)h(discarded,)g(and)f(the)h(previous)f
(checkpoint)f(will)h(not)f(be)i(changed.)16 b(\(Of)10
b(course)257 1357 y(these)i(steps)g(are)g(performed)g(by)f(the)g
Fe(Checkpoint)f Fk(procedure)h(in)g(the)g(generic)h Fe(Stable)e
Fk(inter)o(-)257 1407 y(face,)g(so)e(there)f(is)g(no)h(reason)g(for)f
(the)g(typical)g(client)f(of)i(stable)f(objects)g(to)g(recode)i(this)d
(procedure.)257 1457 y(But)11 b(if)g(you)g(are)h(implementing)e(your)h
(own)g(log)g(managers,)i(it)e(is)g(important)f(to)h(know)g(how)g(the)
257 1507 y(methods)f(will)f(be)i(used)f(by)g(your)g(clients.\))320
1557 y(An)g(application)g(may)h(close)g(the)g(writer)f(returned)g(by)g
Fe(endCheckpoint)e Fk(\(for)i(example,)i(to)257 1606
y(free)d(up)f(\256le)g(descriptors)g(or)f(other)h(resources)h
(associated)g(with)e(inactive)h(stable)g(objects\).)13
b(If)8 b(this)257 1656 y(writer)i(has)h(been)f(closed,)h(the)f(call)419
1731 y Fe(lm.reopenLog\(nm\))257 1806 y Fk(will)f(return)h(a)h(writer)e
(which)h(will)f(append)h(to)g(the)g(current)g(redo)g(log.)320
1856 y(The)h(call)419 1930 y Fe(lm.recoverable\(nm\))257
2005 y Fk(returns)d Fe(TRUE)f Fk(if)h(and)g(only)f(if)h(the)g
(repository)f(managed)i(by)f Fe(lm)g Fk(contains)f(a)i(snapshot)f
(named)h Fe(nm)p Fk(.)320 2055 y(The)i(call)419 2130
y Fe(lm.emptyLog\(nm\))257 2204 y Fk(returns)e Fe(TRUE)g
Fk(if)g(and)h(only)e(if)h(the)g(repository)f(managed)j(by)e
Fe(lm)g Fk(contains)g(a)h(snapshot)f Fe(nm)g Fk(which)257
2254 y(has)g(an)g(empty)f(log.)13 b(The)c(log)f(will)f(be)h(empty)h(if)
f(the)g(program)g(that)g(created)h(a)g(stable)g(object)e(did)h(a)257
2304 y(checkpoint)f(right)e(before)i(terminating.)12
b(A)7 b(non)f(empty)h(log)f(might)g(indicate)g(a)i(crashed)f(program.)
257 2354 y Fe(emptyLog\(\))i Fk(will)g(raise)h(the)g(exception)g(if)g
(there)g(is)g(no)g(snapshot)g Fe(nm)p Fk(.)320 2403 y(The)h(call)419
2478 y Fe(lm.recover\(nm,)19 b(cprd,)i(logrd\))963 2628
y Fk(8)p eop
%%Page: 9 9
9 8 bop 257 262 a Fk(sets)11 b Fe(cprd)f Fk(and)h Fe(logrd)f
Fk(to)g(readers)h(whose)g(sources)g(are)h(the)e(checkpoint)g(and)h
(redo)f(log)g(named)257 311 y Fe(nm)p Fk(,)f(respectively)m(,)h
(assuming)f(a)g(snapshot)f(exists)g(under)h(that)f(name)i(in)e(the)g
(repository)g(managed)257 361 y(by)i Fe(lm)p Fk(.)320
411 y(The)h(call)419 485 y Fe(lm.dispose\(nm\))257 559
y Fk(discards)d(any)f(snapshot)g(named)h Fe(nm)f Fk(from)g
Fe(lm)p Fk(')n(s)f(repository)g(and)h(reclaims)h(any)g(associated)g
(stable)257 609 y(storage.)320 659 y(So)j(much)i(for)e(the)g(methods)h
(of)g(a)g(general)g Fe(LogManager.T)p Fk(.)e(Almost)h(all)g(clients)h
(will)e(use)257 709 y(a)k Fe(LogManager.Default)p Fk(,)e(which)h(uses)h
(the)f(ordinary)g(\256le)g(system)h(as)h(its)d(source)i(of)g(stable)257
759 y(storage.)g(A)d Fe(LogManager.Defau)o(lt)c Fk(must)k(be)f
(initialized)f(by)g(the)i(client;)e(to)g(obtain)h(one,)g(call)419
833 y Fe(VAR)21 b(lm)h(:=)f(NEW\(LogManager.Def)o(ault\))o(.init)o
(\(\);)e(...)257 907 y Fk(The)11 b(methods)f(of)g(a)g
Fe(LogManager.Default)d Fk(interpret)i Fe(nm)h Fk(as)g(a)h(directory)e
(in)h(the)g(\256le)g(system,)257 957 y(in)g(which)f(they)g(expects)i
(to)e(\256nd)h(\256les)g(containing)e(a)i(checkpoint)f(and)h(log.)j
(The)e Fe(beginCheck-)257 1007 y(point)i Fk(method)h(will)e(create)k
(the)d(directory)g(if)g(necessary)m(.)27 b(File)14 b(renaming)g(is)f
(used)h(to)g(make)257 1057 y(checkpoint)c(atomic)g(with)f(respect)i(to)
f(crashes.)320 1106 y(The)g(variable)g Fe(LogManager.defaul)o(t)d
Fk(is)j(initialized)e(by)i(the)f Fe(LogManager)f Fk(module)i(to)f(a)257
1156 y(valid)h Fe(LogManager.Defau)o(lt)p Fk(.)257 1320
y Fi(4)60 b(Manpage)15 b(for)f(the)h(stub)h(generator)257
1421 y Fb(4.1)50 b(Name)257 1499 y Fh(stablegen)11 b
Fk(\261)f(Generate)h(stubs)f(for)g(stable)g(objects.)257
1617 y Fb(4.2)50 b(Syntax)257 1695 y Fh(stablegen)21
b Fk([)p Fh(-i)10 b Ff(Interfaces)p Fk(])g([)p Fh(-o)g
Ff(StableObjectIntf)c Fk(])h([)p Fh(-im)i Ff(StableObjectImpl)p
Fk(])f([)p Fh(-rm)i Ff(RepMod-)361 1745 y(ule)p Fk(])g([options])257
1863 y Fb(4.3)50 b(Description)257 1941 y Fk(The)11 b(program)f
Ff(stablegen)g Fk(generates)h(stubs)e(for)h(Modula-3)f(stable)h
(objects.)k(Stable)c(objects)g(are)257 1990 y(Modula-3)g(objects)g
(whose)g(state)h(is)f(backed)h(up)f(on)g(the)h(disk)e(or)i(other)e
(stable)i(medium,)g(so)f(that)257 2040 y(it)g(will)f(survive)g(program)
h(crashes.)320 2090 y(It)h(is)i(not)e(intended)g(to)h(be)h(used)f(from)
g(the)h(command)g(line.)19 b(Use)13 b Ff(m3build)f Fk(and)g(the)g
(quake)257 2140 y(macros)g Ff(stableobj)d Fk(and)i Ff(Stableobj)d
Fk(instead)j(to)e(run)h(the)h(stub)f(generator)g(\(see)h(the)g(m3build)
e(sec-)257 2190 y(tion)g(below\).)320 2239 y(The)i(command)357
2321 y Fj(stablegen)24 b(-i)h(Data)f(-o)h(Data)g(-im)f(Impl)h(-rm)f
(Rep)320 2403 y Fk(writes)6 b(into)g(\252)p Ff(Impl)p
Fj(.m3)p Fk(\272)g(an)h(implementation)f(of)g(the)h(generic)g
(interface)g(\252)p Fj(Stable\(Data\))p Fk(\272.)257
2453 y(See)13 b(this)e(generic)h(interface)g(for)g(the)f
(speci\256cations)h(of)g(the)g(methods)f(and)h(procedures)g(imple-)257
2503 y(mented)e(by)f Ff(stablegen)p Fk(.)k(Thus)c Ff(Data)f
Fk(should)g(be)i(the)f(name)h(of)f(an)g(interface)h(and)f
Ff(Data)p Fk(.T)g(should)963 2628 y(9)p eop
%%Page: 10 10
10 9 bop 257 262 a Fk(name)9 b(an)e(object)g(type;)h
Ff(stablegen)e Fk(implements)h(a)h(stable)g(version)e(of)h
Ff(Data)p Fk(.T)g(and)h(writes)f(the)g(im-)257 311 y(plementation)i(to)
f(\252)p Ff(Impl)p Fj(.m3)p Fk(\272.)14 b Ff(Impl)9 b
Fk(defaults)f(to)h(the)g(objects)h(interface)f(name)i(as)f(stated)f(in)
g(the)257 361 y(-o)f(option)e(with)i(\252)p Fj(Stable)p
Fk(\272)g(prepended.)13 b(All)8 b(interfaces)g(that)g(contain)f
(revealations)h(of)g Ff(Data)p Fk(.T)257 411 y(must)h(be)h(listed)e
(after)h(the)g(-i)g(parameter)n(.)14 b(The)c(\256rst)f(interface)g(of)g
(the)g(list)f(must)g(contain)h(the)g(most)257 461 y(speci\256c)14
b(supertype)e(of)g Ff(Data)p Fk(.T)m(.)g(In)g(most)h(cases)h(this)d
(will)g(be)i Ff(Data)f Fk(itself.)19 b(But)12 b(if)g
Ff(Data)f Fk(does)257 511 y(not)f(state)h(any)g(more)g(speci\256c)g
(supertyp)f(of)g Ff(Data)p Fk(.T)g(than)h Fj(ROOT)p Fk(,)f(the)h
(interface)g(listet)e(after)i(the)257 560 y(-i)f(will)f(be)i(the)f(one)
g(containing)f(the)h(most)g(speci\256c)h(revealation.)320
610 y(T)m(o)f(complete)h(your)e(program,)i(you)e(should)g(include)h(in)
g(the)g(\256le)g(\252)p Ff(Impl)p Fj(.i3)p Fk(\272)g(the)g(text)357
680 y Fj(INTERFACE)24 b(Impl)h(=)f(Stable\(Data\))g(END)h(Impl.)320
750 y Fk(The)8 b(implementation)e(of)i(stable)f(objects)h(consists)f
(of)g(two)g(modules.)13 b(The)8 b(\256rst)g(is)f(generated)257
800 y(by)i Ff(stablegen)p Fk(,)g(the)g(second)g(is)g(an)h
(instantiation)c(of)j(the)g(generic)g(module)g(\252)p
Fj(StableRep)p Fk(\272.)14 b(The)257 850 y(name)g(of)f(this)f(second)h
(module)f(is)h(stated)g(after)g(the)g(-rm)f(option.)20
b(It)13 b(defaults)f(to)g(the)h(name)h(of)257 900 y(the)f(generated)g
(implementation)e Ff(Impl)g Fk(with)h(\252)p Fj(Rep)p
Fk(\272)h(appended.)21 b(If)12 b(both)f(module)h(names)i(are)257
949 y(defaulted,)g(\252)p Fj(Stable)p Ff(Data)p Fj(Rep)p
Fk(\272)e(will)f(be)j(used)f(for)f(the)h(generic')n(s)f(instantiation.)
20 b(So)13 b(in)f(the)257 999 y(\256le)f(\252)p Ff(Rep)p
Fj(.i3)p Fk(\272)g(you)f(will)f(need)i(the)f(text)357
1069 y Fj(INTERFACE)24 b(Rep)h(=)g(StableRep\(Impl\))e(END)i(Rep.)320
1139 y Fk(And)9 b(the)i(\256le)f(\252)p Ff(Rep)p Fj(.m3)p
Fk(\272)i(looks)d(like)357 1209 y Fj(MODULE)24 b(Rep)h(=)g
(StableRep\(Impl\))e(END)i(REP.)320 1279 y Fk(The)11
b(m3build)d(macros)k(will)d(also)h(generate)h(all)f(these)g(\256les)h
(\(see)g(below\).)257 1395 y Fb(4.4)50 b(Classifying)12
b(the)g(methods)257 1472 y Fk(The)i(interface)e(\252)p
Ff(Data)p Fj(.i3)p Fk(\272)h(presented)f(to)g(the)h(stub)e(generator)i
(must)f(contain)g(a)h(pragma)g(that)257 1522 y(lists)8
b(all)h(methods)f(of)h Ff(Data)p Fk(.T)g(that)f(modify)g(the)g(state)h
(of)g(the)g(object.)k(The)c(pragma)h(has)f(the)g(form)357
1592 y Fj(<*)25 b(STABLE)f(UPDATE)g(METHODS)h(m_1,)f(...,)h(m_k)f(*>)
320 1662 y Fk(where)14 b(the)g(m')n(s)f(are)i(the)f(names)h(of)e(the)h
(update)f(methods)h(of)f Ff(Data)p Fk(.T)m(.)h(The)h(stub)e(genera-)257
1712 y(tor)f(will)g(override)g(these)i(methods)e(to)g(log)g(their)g(ar)
o(guments)i(before)f(calling)f(the)g(correspond-)257
1762 y(ing)d(method)g(of)h(the)f(supertype.)k(The)e(stub)e(generator)g
(will)f(not)h(override)g(the)h(other)f(methods)g(of)257
1812 y Ff(Data)p Fk(.T)n(;)g(the)h(stable)g(object)f(will)g(simply)g
(inherit)f(them)j(from)e(its)g(supertype.)14 b(The)d(pragma)f(may)257
1861 y(appear)i(more)g(than)f(once)g(\(the)g(list)f(stated)h(in)g(the)g
(second)g(pragma)h(will)e(be)h(appended)g(to)g(those)257
1911 y(methods)h(already)g(mentioned\).)17 b(Y)l(ou)11
b(may)h(use)g Fj(ANY)g Fk(instead)f(of)h(a)g(list)e(of)i(methods)f(in)g
(which)257 1961 y(case)h(all)e(methods)g(of)g(the)g(object)g(are)h
(treated)f(as)h(update)f(methods.)257 2077 y Fb(4.5)50
b(Options)257 2154 y Fk(The)10 b(stub)e(generator)h(is)g(based)h(on)e
(the)h(Modula)g(3)f(toolkit,)g(therefore)h(the)f(other)h(options)e
(de\256ned)257 2204 y(by)13 b(the)g(toolkit)d(are)k(available.)22
b(See)14 b(the)f(manpage)h(for)e Ff(m3fe)h Fk(for)f(a)i(list)e(of)g
(these)h(options.)21 b(In)257 2254 y(particular)n(,)12
b(it)e(is)i(possible)e(to)h(set)h(the)f(search)h(path)f(used)h(by)f
(the)g(stub)g(generator)g(with)f(the)h Fj(-T)p Ff(x)257
2304 y Fk(option,)f(where)h Ff(x)g Fk(is)g(the)f(name)i(of)e(a)h(map)g
(\256le)g(generated)g(by)g(m3build.)i(The)f(name)f(of)g(the)f(map)257
2354 y(\256le)i(associated)g(with)e(package)i Ff(P)f
Fk(and)h(build)d(directory)h Ff(B)i Fk(is)f Fj(P/B/.M3IMPORTS)p
Fk(.)f(It)h(is)g(also)257 2403 y(possible)h(to)h(set)g(a)g(speci\256c)h
(search)g(path)f(with)f(the)g Fj(-D)h Fk(option,)f(though)g(this)g(is)g
(usually)g(more)257 2453 y(trouble)d(than)h(it)g(is)g(worth.)320
2503 y(Y)l(ou)f(may)i(use)g(-help)f(instead)g(of)g(any)g(other)g
(options)e(to)i(get)g(a)h(list)e(of)h(available)g(options.)953
2628 y(10)p eop
%%Page: 11 11
11 10 bop 257 262 a Fb(4.6)50 b(Restrictions)257 339
y Fk(As)10 b(mentioned)f(before,)h(not)f(all)g(types)h
Ff(Data)p Fk(.T)f(are)i(valid)e(for)g(stub)g(generation.)k(The)d
(following)257 389 y(restrictions)g(apply)m(.)16 b(The)c(stub)e
(generator)h(will)e(not)i(produce)f(stubs)h(for)f(types)h(that)f
(violate)h(any)257 439 y(of)f(the)g(restrictions.)309
522 y(1.)21 b(No)11 b(ar)o(gument)g(to)g(an)g(update)g(method)g(may)h
(be)f(of)g(type)g Fj(PROCEDURE)f Fk(or)h(have)h(a)f(com-)361
572 y(ponent)f(of)f(type)h Fj(PROCEDURE)p Fk(.)309 655
y(2.)21 b(The)8 b(name)f(of)g(the)g(update)f(methods)h(listed)f(in)g
(the)h Fj(STABLE)24 b(UPDATE)g(METHODS)7 b Fk(pragma)361
705 y(must)g(not)f(con\257ict)g(with)g(the)h(names)h(of)e(the)h(stable)
g(object)f(methods)h(as)g(declared)h(in)e Fj(Stable.ig)p
Fk(.)257 788 y(The)12 b(marshaling)f(of)g(parameters)h(to)f(update)g
(methods)g(is)g(performed)g(as)h(for)e(network)h(objects,)257
837 y(as)g(speci\256ed)g(in)f(the)g(documentation)f(for)h
Ff(stubgen)p Fk(.)257 956 y Fb(4.7)50 b(Generating)12
b(stubs)g(using)g(m3build)257 1034 y Fk(Currently)e(the)h(macros)h
(described)g(here)f(only)g(support)f(the)h(defaults)f(for)h(the)g
(\256lenames)i(of)e(the)257 1083 y(generated)g(module)f(and)g(the)g
(instatiated)f(generic)i(part)f(of)g(the)g(implementation.)320
1133 y(It)e(is)h(possible)g(to)f(manage)j(stub)d(generation)h(using)f
Ff(m3build)p Fk(.)k(Y)l(ou)d(must)g(put)f(the)h(following)257
1183 y(line)h(in)g(your)f Ff(m3make\256le)p Fk(,)i(prior)e(to)h(any)g
(occurrences)i(of)e(one)g(of)g(the)g(macros:)357 1266
y Fj(import\("stable"\))320 1349 y Fk(T)m(o)g(state)h(that)e(an)i
(interface)f Ff(Data)g Fk(contains)g(a)g(stable)h(object)e(use)i(one)f
(of)g(the)h(macros:)357 1432 y Fj(stableobj\("Data",)23
b([]\))357 1482 y(Stableobj\("Data",)g([]\))320 1565
y Fk(\()p Ff(Stableobj)9 b Fk(sets)j(the)f(visability)e(of)i(the)g
(stable)g(object')n(s)f(interface)i(to)f(visible,)f Ff(stableobj)g
Fk(to)257 1615 y(hidden\))e(which)h(generates)g(stubs)g(for)f
Ff(Data)p Fk(.T)m(,)h(storing)e(them)i(in)g(\252)p Fj(Stable)p
Ff(Data)p Fj(.m3)p Fk(\272.)j(It)d(gen-)257 1665 y(erate)h(the)f
(instatiation)e(of)h Fj(Stable.ig)h Fk(in)f(\252)p Fj(Stable)p
Ff(Data)p Fj(.i3)p Fk(\272)g(and)h(the)g(instatiation)e(of)i(the)257
1714 y(generic)e(part)g(of)f(the)h(implementation)f(\()p
Fj(StableRep)p Fk(\))f(in)i(\252)p Fj(Stable)p Ff(Data)p
Fj(Rep.i3)p Fk(\272)e(and)i(\252)p Fj(Stable)p Ff(Data)p
Fj(Rep.i3)p Fk(\272.)257 1764 y(It)j(also)g(arranges)h(for)f(the)g
(generated)h(stubs)f(to)f(be)i(compiled)f(and)g(linked)f(into)g(the)h
(program.)320 1814 y(The)e(second)h(parameter)g(of)f(the)g(macros)h(is)
f(a)h(list)e(of)g(interfaces)i(that)e Ff(Data)h Fk(depends)g(on.)13
b(The)257 1864 y(\256rst)f(in)f(the)h(list)e(must)i(be)g(the)g
(interface)g(containing)e(the)i(most)f(speci\256c)i(exported)e
(revealation)257 1914 y(of)g Ff(Data)p Fk(.T)m(.)h(The)g(following)c
(interface)k(names)g(are)g(only)f(used)g(to)g(trigger)f
Ff(stablegen)g Fk(correctly)m(.)257 1963 y(If)i(one)g(of)g(those)g
(interfaces)g(are)h(changed,)h Ff(stablegen)d Fk(will)g(be)h(run)f
(again)i(on)e(the)h(next)g(call)g(of)257 2013 y Ff(m3build)p
Fk(.)320 2063 y(If)e(the)h(second)g(parameter)h(is)f(the)f(empty)h
(list,)f(it)g(is)h(assumed)h(that)e(\252)p Ff(Data)p
Fj(.i3)p Fk(\272)g(is)h(the)g(only)257 2113 y(interface)g(containing)e
(de\256nitions)f(necessary)k(for)e Ff(Data)p Fk(.T)m(.)320
2163 y(The)h(rules)g(for)f(importing)e(interfaces)k(during)d(stub)h
(generation)g(are)h(the)g(same)h(as)g(those)e(for)257
2213 y(compilation)f(under)h Ff(m3build)p Fk(.)i(See)g(the)e
Ff(m3build)f Fk(manpage)i(for)f(further)f(detail.)257
2352 y Fi(5)60 b(Sample)14 b(stub)i(generator)d(output)257
2445 y Fk(As)g(an)f(example)h(consider)e(the)h(following)e(simple)i
(interface)g(which)g(declares)h(an)f(object)g(with)257
2495 y(one)f(single)e(update)h(method:)953 2628 y(1)n(1)p
eop
%%Page: 12 12
12 11 bop 357 262 a Fe(INTERFACE)20 b(Data;)357 309 y(TYPE)h(T)h(<:)f
(Public;)401 357 y(Public)f(=)i(OBJECT)e(METHODS)h(update\(i:)f
(INTEGER\))g(END;)401 405 y(<*STABLE)g(UPDATE)g(METHODS)h(update*>)357
455 y(END)g(Data.)320 527 y Fk(If)13 b(you)f(run)h(the)g(stub)f
(generator)h(on)g(this)f(\256le,)j(it)d(will)g(produce)h(the)g
(following)e(in)h(the)h(\256le)257 577 y Fj(StableData.m3)p
Fk(:)357 648 y Fe(MODULE)21 b(StableData;)357 718 y(IMPORT)g
(StableDataRep,)d(StableError,)i(StableLog,)f(Rd,)j(Data;)357
789 y(TYPE)401 836 y(Methods)e(=)i({update};)357 907
y(REVEAL)401 955 y(T)f(=)h(StableDataRep.Pu)o(blic)c(BRANDED)j(OBJECT)
531 1002 y(OVERRIDES)531 1050 y(replayLog:=)f(ReplayLog;)531
1121 y(update)h(:=)g(Log_update;)488 1169 y(END;)357
1239 y(PROCEDURE)f(Log_update\(self:)e(T;)k(i_arg:)e(INTEGER\))g
(RAISES)h({})g(=)401 1287 y(BEGIN)444 1335 y(IF)h(self.lm)e(=)h(NIL)h
(THEN)488 1382 y(Data.T.update\(se)o(lf,)d(i_arg\))444
1430 y(ELSE)488 1478 y(TRY)531 1526 y(StableDataRep.ReOpe)o(nLog\()o
(self\))o(;)531 1573 y(StableLog.OutCall\(s)o(elf.l)o(og,)g
(ORD\(Methods.upd)o(ate\)\))o(;)531 1621 y(StableLog.OutIntege)o
(r\(sel)o(f.log)o(,)g(i_arg\);)531 1669 y(TRY)575 1716
y(Data.T.update\(sel)o(f,)g(i_arg\))531 1764 y(FINALLY)575
1812 y(StableLog.OutCall)o(EndMa)o(rk\(se)o(lf.lo)o(g\);)575
1860 y(IF)i(self.forceToDisk)e(THEN)i(self.flushLog\(\))d(END)531
1907 y(END)488 1955 y(EXCEPT)531 2003 y(StableError.E\(err\))g(=>)575
2051 y(<*NOWARN*>)i(StableError.Halt)o(\()793 2098 y("can)h(not)g
(flush)g(log)g(\("&)g(StableError.ToText)o(\(err\))793
2146 y(&)g("\))h(in)f(dir)g(")h(&)g(self.nm\);)488 2194
y(END)444 2242 y(END)401 2289 y(END)f(Log_update;)357
2360 y(PROCEDURE)f(ReplayLog\(o:)f(T;)j(log:)f(Rd.T\))f(=)401
2408 y(BEGIN)444 2455 y(TRY)488 2503 y(LOOP)953 2628
y Fk(12)p eop
%%Page: 13 13
13 12 bop 531 262 a Fe(CASE)21 b(VAL\(StableLog.InCal)o(l\(log)o(,)e
(ORD\(LAST\(Methods\))o(\)\),)g(Meth-)257 309 y(ods\))i(OF)553
357 y(|)h(Methods.update)d(=>)i(Replay_update\(o,)d(log\);)531
405 y(END)k(\(*CASE*\))488 452 y(END)f(\(*LOOP*\))444
500 y(EXCEPT)466 548 y(ELSE)444 596 y(END;)401 643 y(END)g(ReplayLog;)
357 716 y(PROCEDURE)f(Replay_update\(sel)o(f:)f(T;)i(log:)g(Rd.T\))g
(RAISES)f({StableLog.Error}=)401 764 y(VAR)444 812 y(i_arg:)h(INTEGER;)
401 859 y(BEGIN)444 907 y(i_arg)g(:=)g(StableLog.InInteger)o(\(log\))o
(;)444 955 y(IF)h(NOT)f(StableLog.CheckC)o(allEn)o(dMark)o(\(log\))d
(THEN)488 1002 y(RAISE)j(StableLog.Error)444 1050 y(END;)444
1098 y(TRY)488 1146 y(Data.T.update\(se)o(lf,)e(i_arg\))444
1193 y(EXCEPT)i(ELSE)444 1241 y(END)401 1289 y(END)g(Replay_update;)357
1362 y(PROCEDURE)f(Checkpoint\(o:)f(T\))i(RAISES)g({StableError.E})e(=)
401 1409 y(BEGIN)444 1457 y(StableDataRep.Chec)o(kpoin)o(t\(o\))401
1505 y(END)i(Checkpoint;)357 1577 y(BEGIN)357 1627 y(END)g(StableData.)
257 1792 y Fi(6)60 b(Example)257 1885 y Fk(This)11 b(section)f
(contains)f(an)i(example)g(of)f(the)g(use)h(of)f(stable)g(objects.)257
1959 y(The)h(example)g(program)e(declares)i(a)g(simple)f(stable)g
(object)f(and)h(allows)g(the)f(user)i(to)e(drive)g(state)257
2009 y(modi\256cations)h(and)g(stability)e(from)i(the)g(keyboard.)257
2128 y Fb(6.1)50 b(Object)12 b(Interface)257 2205 y Fk(The)f(stable)g
(object)e(is)h(called)h Fe(Fib)f Fk(and)g(generates)h(a)g(sequence)g
(of)f(Fibonacci)g(numbers.)357 2303 y Fe(INTERFACE)20
b(Fib;)357 2376 y(TYPE)h(T)h(<:)f(Public;)466 2423 y(Public)g(=)g
(OBJECT)466 2473 y(METHODS)953 2628 y Fk(13)p eop
%%Page: 14 14
14 13 bop 257 262 a Fe(Fib)8 b Fk(has)h(three)f(initialization)d
(methods:)12 b Fe(init)c Fk(is)g(the)g(standard,)h(non-stable)e
(initializer;)g Fe(initS)257 311 y Fk(initializes)i(the)h(stable)h
(state;)f(and)g Fe(initT)f Fk(initializes)g(the)h(transient)f(state.)
510 409 y Fe(init\(newFirst)19 b(:)i(INTEGER;)f(newSecond)g(:)i
(INTEGER\))e(:)i(T;)510 457 y(initS\(newFirst)c(:)k(INTEGER;)e
(newSecond)g(:)i(INTEGER\);)510 506 y(initT\(\);)257
581 y Fk(The)13 b(other)f(two)g(methods)g(modify)g(and)g(examine)h(the)
f(state)h(of)f(the)g(object:)17 b Fe(crank)12 b Fk(generates)257
631 y(a)h(new)f(Fibonacci)f(number)n(.)18 b Fe(count)11
b Fk(returns)g(the)g(number)h(of)f(times)h(that)f(the)h(object)f(has)h
(been)257 681 y(cranked)f(during)e(the)h(current)g(invocation)f(of)h
(the)g(program.)510 778 y Fe(crank\(times)19 b(:)j(INTEGER\))e(:)h
(INTEGER;)510 826 y(count\(\))f(:)h(INTEGER;)466 876
y(END;)257 951 y Fk(Here)11 b(is)f(the)h Fe(STABLE)e
Fk(pragma)i(that)e(the)h(stub)g(generator)g(needs:)466
1050 y Fe(<*PRAGMA)20 b(STABLE)h(*><*STABLE)e(UPDATE)i(METHODS)f
(initS,)h(crank)g(*>)357 1112 y Fc(initS)16 b Fd(is)h(the)h(only)e
(initialization)f(function)h(that)i Fc(stablegen)d Fd(needs)j(to)f
(see.)357 1162 y Fc(init)e Fd(is)g(used)h(for)f(the)h(unstable)g(v)o
(ersion)g(of)f(the)h(ob)r(ject,)g(and)f Fc(initT)g Fd(do)q(es)h(not)357
1212 y(mo)q(dify)c(the)i(stable)g(state.)257 1287 y Fk(The)d
Fe(Brand)f Fk(is)g(a)h(convention)d(used)j(by)f(all)g(generic)g
(interfaces,)h(including)d(stable)j(objects:)357 1384
y Fe(CONST)21 b(Brand)g(=)g("Fib";)357 1459 y(END)g(Fib.)257
1627 y Fb(6.2)50 b(Object)12 b(Implementation)357 1753
y Fe(MODULE)21 b(Fib;)357 1828 y(REVEAL)g(T)g(=)h(Public)e(BRANDED)h
(OBJECT)257 1902 y Fk(Before)13 b(using)e(the)i(stable)f(package,)i(it)
e(is)g(best)g(to)g(separate)i(the)e(stable)g(and)h(transient)e(state)i
(of)257 1952 y(the)e(object)e(to)h(be)h(stabilized.)i(For)d(example,)i
Fe(Fib)d Fk(has)i(two)f(stable)g(state)h(variables.)j(These)d(two)257
2002 y(integers)i(are)h(used)g(to)f(generate)h(Fibonacci)f(numbers.)24
b(They)13 b(are)i(initialized)c(by)i Fe(initS)g Fk(and)257
2052 y(modi\256ed)d(by)g Fe(crank)p Fk(.)401 2149 y Fe(first)42
b(:)22 b(INTEGER;)401 2199 y(second)e(:)i(INTEGER;)257
2274 y(Fib)11 b Fk(has)g(one)g(transient)f(state)g(variable.)16
b(This)11 b(integer)f(corresponds)g(to)g(the)h(number)g(of)f(cranks)257
2324 y(during)f(the)h(current)g(session.)k Fe(initT)c
Fk(initializes)e(this)i(variable.)401 2423 y Fe(times)42
b(:)22 b(INTEGER;)257 2498 y Fk(The)11 b(entire)f(implementation)f(of)h
(this)f(object)h(is)g(in)g(this)f(module.)953 2628 y(14)p
eop
%%Page: 15 15
15 14 bop 401 262 a Fe(OVERRIDES)444 309 y(init)65 b(:=)21
b(Init;)444 357 y(initS)43 b(:=)21 b(InitStable;)444
405 y(initT)43 b(:=)21 b(InitTransient;)444 452 y(crank)43
b(:=)21 b(Crank;)444 500 y(count)43 b(:=)21 b(Count;)401
550 y(END;)257 625 y(Init)13 b Fk(is)f(used)h(to)g(initialize)e(the)i
(unstable)f(version)g(of)h(the)g(object.)21 b(It)13 b(circumvents)f
(the)h(stubs)257 675 y(from)f Fe(stablegen)e Fk(and)h(calls)h
Fe(InitStable)e Fk(and)h Fe(InitTransient)e Fk(separately)m(.)19
b(The)12 b(proce-)257 724 y(dure)f(calls)g Fe(InitStable)e
Fk(before)i(calling)f Fe(InitTransient)p Fk(,)e(because)13
b(\(in)d(general\))h(the)f(tran-)257 774 y(sient)g(state)h(might)e
(depend)h(on)g(the)g(stable)g(state)h(but)e(not)h(vice)g(versa.)357
872 y Fe(PROCEDURE)20 b(Init\(fib)g(:)i(T;)f(newFirst)f(:)i(INTEGER;)e
(newSecond)g(:)h(INTEGER\))g(:)g(T)h(=)401 919 y(BEGIN)444
967 y(InitStable\(fib,)d(newFirst,)h(newSecond\);)444
1015 y(InitTransient\(fib\))o(;)444 1063 y(RETURN)h(fib;)401
1112 y(END)g(Init;)257 1187 y(InitStable)11 b Fk(initializes)g(the)h
(two)g(stable)g(state)h(variables.)20 b(For)12 b(the)h(standard)f
(Fibonacci)g(se-)257 1237 y(quence,)g(set)e(newFirst)g(:=)g(0)g(and)h
(newSecond)f(:=)h(1.)357 1335 y Fe(PROCEDURE)20 b(InitStable\(fib)f(:)i
(T;)h(newFirst)e(:)i(INTEGER;)e(newSecond)g(:)h(IN-)257
1382 y(TEGER\))g(=)401 1430 y(BEGIN)444 1478 y(fib.first)42
b(:=)21 b(newFirst;)444 1526 y(fib.second)f(:=)h(newSecond;)401
1575 y(END)g(InitStable;)257 1650 y(InitTransient)8 b
Fk(always)j(sets)f(the)g(number)h(of)f(cranks)g(to)g(zero.)357
1748 y Fe(PROCEDURE)20 b(InitTransient\(fib)e(:)k(T\))f(=)401
1795 y(BEGIN)444 1843 y(fib.times)f(:=)h(0;)401 1893
y(END)g(InitTransient;)257 1968 y(Crank)8 b Fk(performs)h(the)f
(Fibonacci)h(operation)e(and)i(updates)f(the)h(current)f(number)h(of)f
(cranks.)14 b(For)257 2017 y(convenience,)d(the)e(second)g(ar)o(gument)
h(indicates)e(the)h(number)h(of)e(cranks)i(to)f(perform,)g(allowing)257
2067 y(the)i(calling)f(module)g(to)g(avoid)g(having)g(to)g(repeat)h
(calls)g(to)f Fe(Crank)p Fk(.)k(This)d(type)f(of)h(optimization)257
2117 y(is)d(especially)h(important)e(for)g(the)h(stable)h(object,)f
(because)i(the)e(stable)g(version)g(of)g Fe(Crank)f Fk(creates)257
2167 y(a)k(log)f(entry)f(on)h(disk)g(every)g(time)h(the)f(function)e
(is)i(called.)357 2264 y Fe(PROCEDURE)20 b(Crank\(fib)g(:)h(T;)h(times)
f(:)g(INTEGER)g(:=)g(1\))g(:)h(INTEGER)e(=)401 2312 y(VAR)h(temp)g(:)g
(INTEGER;)401 2360 y(BEGIN)444 2408 y(FOR)g(Count)g(:=)g(1)h(TO)f
(times)g(DO)488 2455 y(temp)g(:=)g(fib.second;)488 2503
y(fib.second)e(:=)j(fib.first)e(+)h(temp;)953 2628 y
Fk(15)p eop
%%Page: 16 16
16 15 bop 488 262 a Fe(fib.first)20 b(:=)h(temp;)444
309 y(END;)444 357 y(fib.times)f(:=)h(fib.times)f(+)i(times;)444
405 y(RETURN)f(fib.second;)401 455 y(END)g(Crank;)257
529 y(Count)10 b Fk(returns)f(the)h(current)g(number)h(of)f(cranks.)357
626 y Fe(PROCEDURE)20 b(Count\(fib)g(:)h(T\))h(:)f(INTEGER)g(=)401
674 y(BEGIN)444 721 y(RETURN)g(fib.times;)401 769 y(END)g(Count;)357
841 y(BEGIN)357 891 y(END)g(Fib.)257 1059 y Fb(6.3)50
b(Driving)12 b(the)g(stable)g(object)257 1136 y Fk(The)d
Fe(Example)e Fk(module)h(creates)i(the)e Fe(StableFib)e
Fk(object)i(and)h(allows)e(the)h(user)h(to)f(drive)f(it)h(from)257
1186 y(the)j(keyboard.)16 b(This)11 b(application)e(expects)j(one)f
(parameter)h(on)f(the)g(command)g(line:)j(the)d(path-)257
1236 y(name)g(to)e(be)h(used)g(to)f(hold)g(the)h(stable)f(state.)15
b(It)9 b(assumes)i(that)e(the)h(user)g(has)g(created)h(the)e(root)g(of)
257 1286 y(the)h(pathname)h(\(everything)e(up)h(to)g(the)g(last)g
(slash)g(\(/\))g(in)f(the)h(\256lename\).)320 1336 y(The)h(application)
d(prompts)i(the)g(user)g(for)g(one)h(of)f(six)f(commands:)324
1418 y(s)21 b(Initialize)6 b(the)h(stable)g(state)g(of)g(the)g
(Fibonacci)f(object.)13 b(The)8 b(application)d(prompts)h(the)h(user)
361 1468 y(for)j(the)g(two)g(stable)g(state)g(variables.)322
1550 y(c)21 b(Crank)10 b(the)h(Fibonacci)g(object.)k(The)c(application)
f(prompts)g(the)g(user)h(for)g(the)f(number)h(of)361
1600 y(times)f(to)g(crank.)320 1683 y(d)20 b(Dispose)10
b(of)g(the)g(stable)h(state)f(\(terminate)g(stability\).)329
1766 y(i)20 b(Initialize)9 b(the)h(stable)g(state)h(\(restabilize\).)i
(Use)e(this)e(command)i(only)e(after)h(disposing)f(of)361
1815 y(the)h(object.)320 1898 y(k)20 b(Checkpoint)8 b(the)i(object.)j
(Make)d(sure)g(that)f(the)h(object)f(is)g(stable)h(before)g(using)e
(this)h(com-)361 1948 y(mand.)320 2031 y(q)20 b(Quit)9
b(the)h(example)h(\(terminate)f(the)h(application\).)357
2160 y Fe(MODULE)21 b(Example)f(EXPORTS)g(Main;)357 2210
y(IMPORT)h(Wr,)g(Stdio,)f(Fmt,)h(IO,)g(StableFib,)f(Pathname,)g
(StableError,)f(Params;)257 2284 y Fk(This)12 b(module)g(handles)f(the)
h Fe(StableError.E)d Fk(and)j Fe(IO.Error)e Fk(exceptions,)j(but)e
(loses)h(on)f(all)257 2334 y(others:)357 2431 y Fe(<*FATAL)20
b(ANY*>)357 2503 y(PROCEDURE)g(Main\(\))g(=)953 2628
y Fk(16)p eop
%%Page: 17 17
17 16 bop 401 262 a Fe(VAR)444 309 y(stablePath)20 b(:)h(Pathname.T;)
444 357 y(recovered)f(:)i(BOOLEAN;)444 405 y(thefib)f(:)g(StableFib.T;)
444 452 y(running)g(:)g(BOOLEAN)f(:=)i(TRUE;)444 500
y(first,)f(second,)f(crank)h(:)g(INTEGER;)401 548 y(BEGIN)444
596 y(\(*)h(Get)f(the)g(pathname)f(or)h(emit)g(a)h(usage)f(error:)f
(*\))444 643 y(IF)i(\(Params.Count)d(=)i(2\))h(THEN)488
691 y(stablePath)d(:=)j(Params.Get\(1\))d(\(*)i(one)h(command-line)d
(argument:)h(the)h(path)g(*\))444 739 y(ELSE)488 787
y(Wr.PutText\(Stdio)o(.stdo)o(ut,)727 834 y("usage:)g(example)f(<path)h
(of)g(stable)g(storage>\\n"\);)488 882 y(RETURN;)444
930 y(END;)444 1004 y(TRY)257 1077 y Fk(Initialize)9
b(the)h(stable)h(storage:)488 1175 y Fe(thefib)20 b(:=)i
(NEW\(StableFib.T\))o(.init)o(\(stab)o(lePa)o(th,)d(recovered\);)257
1249 y Fk(Only)10 b(initialize)e(the)j(stable)f(state)g(if)g(it)f(is)h
(not)g(recovered)h(from)f(the)g(given)g(path:)488 1344
y Fe(IF)21 b(\(recovered\))f(THEN)531 1392 y(Wr.PutText\(Stdio.st)o
(dout,)771 1440 y(Fmt.F\("recovered)f(fib)i(from)g(\045s\\n",)f
(stablePath\)\);)488 1488 y(ELSE)531 1535 y(thefib.initS\(0,)f(1\);)531
1583 y(Wr.PutText\(Stdio.st)o(dout,)f("brand)j(new)g(fib!\\n"\);)488
1633 y(END;)257 1707 y Fk(Always)10 b(initialize)d(the)i(transient)g
(state.)14 b(This)9 b(initialization)d(is)j(performed)h(after)f
(recovering)g(or)257 1756 y(initializing)e(the)i(stable)h(state,)g
(because)h(the)e(transient)g(state)g(might)g(depend)g(on)g(the)h
(stable)f(state.)488 1854 y Fe(thefib.initT\(\);)257
1928 y Fk(The)g(user)f(interface)g(loop)f(isn')o(t)g(anything)f
(special,)j(but)e(it)g(does)h(allow)f(the)g(user)h(to)g(drive)f(the)g
(state)257 1978 y(and)k(stability)d(of)i(the)g Fe(Fib)g
Fk(object.)488 2073 y Fe(WHILE)21 b(\(running\))e(DO)531
2145 y(Wr.PutText\(Stdio.st)o(dout,)771 2193 y("init\(S\),)h
(\(c\)rank,)g(\(d\)ispose,)g(\(i\)nit,)g(chec\(k\))h(or)g(\(q\)uit>)f
(")531 2240 y(\);)531 2288 y(Wr.Flush\(Stdio.stdo)o(ut\);)531
2360 y(CASE)h(\(IO.GetChar\(\)\))e(OF)575 2408 y('q',)i('Q')g(=>)g
(running)g(:=)g(FALSE;)531 2455 y(|)h('k',)f('K')g(=>)g
(StableFib.Checkpoint)o(\(the)o(fib\);)531 2503 y(|)h('s',)f('S')g(=>)
953 2628 y Fk(17)p eop
%%Page: 18 18
18 17 bop 575 262 a Fe(Wr.PutText\(Stdio.)o(stdou)o(t,)19
b(")43 b(first)21 b(value>)f("\);)575 309 y(Wr.Flush\(Stdio.st)o
(dout\))o(;)575 357 y(first)h(:=)g(GetInt\(\);)575 405
y(Wr.PutText\(Stdio.)o(stdou)o(t,)e(")43 b(second)21
b(value>)f("\);)575 452 y(Wr.Flush\(Stdio.st)o(dout\))o(;)575
500 y(second)g(:=)i(GetInt\(\);)575 548 y(thefib.initS\(firs)o(t,)d
(second\);)531 596 y(|)j('c',)f('C')g(=>)575 643 y(Wr.PutText\(Stdio.)o
(stdou)o(t,)e(")43 b(times)21 b(to)g(crank>)g("\);)575
691 y(Wr.Flush\(Stdio.st)o(dout\))o(;)575 739 y(crank)g(:=)g
(GetInt\(\);)575 787 y(Wr.PutText\(Stdio.)o(stdou)o(t,)815
834 y(Fmt.F\("the)e(result)i(is)g(\045s\\n",)945 882
y(Fmt.Int\(thefib.cran)o(k\(cra)o(nk\)\)\))o(\);)575
930 y(Wr.PutText\(Stdio.)o(stdou)o(t,)815 978 y(Fmt.F\("\(\045s)e
(cranks)i(this)g(session\)\\n",)945 1025 y(Fmt.Int\(thefib.coun)o
(t\(\)\)\))o(\);)531 1073 y(|)h('d',)f('D')g(=>)575 1121
y(thefib.dispose\(\);)575 1169 y(Wr.PutText\(Stdio.)o(stdou)o(t,)e
("stability)g(cancelled\\n"\);)531 1216 y(|)j('i',)f('I')g(=>)575
1264 y(thefib)f(:=)i(thefib.init\(stabl)o(ePath)o(,)d(recovered\);)575
1312 y(thefib.initT\(\);)575 1359 y(IF)i(\(recovered\))f(THEN)619
1407 y(Wr.PutText\(Stdi)o(o.std)o(out,)858 1455 y(Fmt.F\("recovered)f
(state)h(from)h(\045s\\n",)g(sta-)257 1503 y(blePath\)\);)575
1550 y(ELSE)619 1598 y(Wr.PutText\(Stdi)o(o.std)o(out,)d("state)j(is)g
(now)g(stable\\n"\);)575 1646 y(END;)531 1694 y(ELSE)g(\(*skip*\))531
1741 y(END;)531 1789 y(EVAL)g(IO.GetLine\(\);)e(\(*)j(ignore)e(the)i
(rest)e(of)i(the)f(line)g(*\))488 1837 y(END;)444 1885
y(EXCEPT)488 1932 y(StableError.E)e(=>)i(Wr.PutText\(Stdio.st)o(derr)o
(,)1098 1980 y("bombed)f(out)h(with)g(stable)g(stor-)257
2028 y(age)h(error\\n"\);)444 2076 y(END;)444 2123 y
(Wr.PutText\(Stdio.s)o(tdout)o(,)d("bye!\\n"\);)401 2173
y(END)i(Main;)257 2247 y Fk(One)11 b(little)d(feature)j(for)f(the)g
(interface:)j(don')o(t)d(bomb)g(out)f(if)h(the)g(user)g(enters)h(a)g
(bad)f(integer)n(.)357 2345 y Fe(PROCEDURE)20 b(GetInt\(\):)g(INTEGER)g
(=)357 2407 y Fd(\(not)14 b(a)g(particularly)f(in)o(teresting)h
(function\))401 2503 y Fe(END)21 b(GetInt;)953 2628 y
Fk(18)p eop
%%Page: 19 19
19 18 bop 357 262 a Fe(BEGIN)401 309 y(Main\(\);)357
359 y(END)21 b(Example.)257 503 y Fb(6.4)50 b(The)13
b(make)g(\256le)257 580 y Fk(Here)e(are)g(the)g Fj(m3makefile)e
Fk(\()p Fj(quake)p Fk(\))h(commands)h(required)f(to)f(build)g(the)h
(example:)307 663 y Fj(import)25 b(\("libm3"\))307 713
y(module)g(\("Fib"\))307 763 y(import)g(\("stable"\))307
813 y(stableobj)f(\("Fib",)h([Fib]\))307 863 y(implementation)f
(\("Example"\))307 912 y(program\("example"\))257 1052
y Fi(7)60 b(Copyright)257 1145 y Fk(Copyright)8 b(1994)i(Digital)e
(Equipment)i(Corporation.)257 1195 y(Distributed)f(only)g(by)h
(permission.)257 1286 y Fj(Last)25 b(modified)f(on)h(Thu)f(Jan)h(12)g
(12:24:27)f(PST)h(1995)f(by)h(chaiken)382 1336 y(modified)f(on)h(Tue)f
(Sep)h(27)g(11:52:22)f(PDT)h(1994)f(by)h(weich)953 2628
y Fk(19)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
